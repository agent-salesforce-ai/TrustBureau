<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrustBureau.ai | Offer Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
  <!-- html2canvas for PNG export of the themed card -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance:none; margin:0; }
    input[type=number] { -moz-appearance:textfield; }
    .input-icon { top:50%; transform:translateY(-50%); }
    .text-shadow-cyan { text-shadow:0 0 15px rgba(34,211,238,.25); }

    /* Base theme variables (overridden by data-mode + accent JS) */
    :root {
      --tb-bg-body: #f3f4f6;   /* page background always light */
      --tb-bg-shell: #020617;
      --tb-bg-panel: #020617;
      --tb-bg-card: #0f172a;
      --tb-border: #1e293b;
      --tb-text-main: #f9fafb;
      --tb-text-muted: #94a3b8;
      --tb-input-bg: #020617;
      --tb-slider-track: #111827;
      --tb-accent: #2563eb; /* default: blue */
    }

    /* Mode: dark â€“ tuned for contrast */
    body[data-mode="dark"] {
      --tb-bg-shell: #020617;   /* shell/nav */
      --tb-bg-panel: #020617;   /* slider panel background */
      --tb-bg-card: #0f172a;    /* inner cards a bit lighter */
      --tb-border:   #1f2937;   /* slate-800 border */
      --tb-text-main:#e5e7eb;
      --tb-text-muted:#9ca3af;
      --tb-input-bg:#020617;
      --tb-slider-track:#1f2937; /* visible rail */
    }

    /* Mode: light */
    body[data-mode="light"] {
      --tb-bg-shell: #f9fafb;
      --tb-bg-panel: #ffffff;
      --tb-bg-card: #ffffff;
      --tb-border: #d1d5db;
      --tb-text-main: #0f172a;
      --tb-text-muted: #6b7280;
      --tb-input-bg: #ffffff;
      --tb-slider-track: #e5e7eb;
    }

    .tb-shell {
      background-color: var(--tb-bg-shell);
      color: var(--tb-text-main);
      border-color: var(--tb-border);
    }
    .tb-panel {
      background-color: var(--tb-bg-panel);
    }
    .tb-card {
      background-color: var(--tb-bg-card);
      border-color: var(--tb-border);
    }
    .tb-input {
      background-color: var(--tb-input-bg);
      color: var(--tb-text-main);
      border-color: var(--tb-border);
    }
    .tb-label-muted {
      color: var(--tb-text-muted);
    }
    .tb-hero {
      color: var(--tb-accent);
    }
    .tb-pill {
      border-color: var(--tb-border);
      background-color: transparent;
      color: var(--tb-text-main);
      transition: background-color 0.15s ease, color 0.15s ease, border-color 0.15s ease;
    }
    .tb-pill-active {
      background-color: var(--tb-accent);
      color: #f9fafb;
      border-color: var(--tb-accent);
    }

    .tb-select {
      background-color: var(--tb-bg-card);
      color: var(--tb-text-main);
      border-color: var(--tb-border);
    }
    body[data-mode="light"] .tb-select {
      background-color: #ffffff;
      color: var(--tb-text-main);
      border-color: var(--tb-border);
    }

    .tb-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 0.4rem;
      border-radius: 9999px;
      background: var(--tb-slider-track);
      outline: none;
    }
    .tb-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      height: 1rem;
      width: 1rem;
      border-radius: 9999px;
      background-color: var(--tb-accent);
      cursor: pointer;
      border: 2px solid #0b1120;
    }
    .tb-slider::-moz-range-thumb {
      height: 1rem;
      width: 1rem;
      border-radius: 9999px;
      background-color: var(--tb-accent);
      cursor: pointer;
      border: 2px solid #0b1120;
    }
    .tb-slider::-webkit-slider-runnable-track,
    .tb-slider::-moz-range-track {
      background: var(--tb-slider-track);
      border-radius: 9999px;
    }
  </style>
</head>
<body data-mode="light" data-accent="blue"
      class="min-h-screen flex items-center justify-center p-2 transition-colors duration-200"
      style="background-color:#f3f4f6;">
  <div id="appShell" class="tb-shell w-full max-w-xl rounded-xl shadow-2xl p-4 md:p-6 space-y-4 border transition-colors duration-200">
    <!-- HEADER -->
    <div class="pb-2 border-b border-slate-700/10 flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <!-- Shield with check, stroke follows accent via currentColor -->
        <svg id="logoIcon" class="h-6 w-6 tb-hero" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.7" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3.25l6 2.25v5.25c0 3.5-2.4 6.75-6 8.25-3.6-1.5-6-4.75-6-8.25V5.5l6-2.25z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 11.75l1.75 1.75 3.75-3.75" />
        </svg>
        <h1 class="text-xl md:text-2xl font-bold">TrustBureau.ai</h1>
      </div>
      <div class="flex items-center space-x-2">
        <select id="modeSelect" class="tb-select text-xs font-semibold px-2 py-1.5 rounded-lg">
          <option value="dark">Dark</option>
          <option value="light" selected>Light</option>
        </select>
        <select id="accentSelect" class="tb-select text-xs font-semibold px-2 py-1.5 rounded-lg">
          <option value="cyan">Cyan</option>
          <option value="indigo">Indigo</option>
          <option value="emerald">Emerald</option>
          <option value="blue" selected>Blue</option>
          <option value="violet">Violet</option>
          <option value="rose">Rose</option>
          <option value="amber">Amber</option>
          <option value="teal">Teal</option>
          <option value="lime">Lime</option>
          <option value="neutral">Neutral</option>
        </select>
        <button id="shareBtn"
                class="inline-flex items-center text-xs font-semibold px-3 py-1.5 rounded-lg border border-slate-300 bg-white/80 hover:bg-white shadow-sm">
          Share
        </button>
      </div>
    </div>

    <!-- OFFER CALCULATOR -->
    <div class="space-y-4 pt-2">
      <h2 class="text-base font-semibold flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 tb-label-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M12 17h.01M15 17h.01M15 14h.01M18 17h.01M18 14h.01M18 11h.01M6 17h.01M6 14h.01M6 11h.01M6 7h.01M3 7h.01M3 11h.01M3 14h.01M3 17h.01M12 3v.01M12 6v.01M12 21v-.01M12 18v-.01"/>
        </svg>
        Offer Calculator
      </h2>

      <!-- Sliders -->
      <div id="cardPanel" class="tb-panel p-4 rounded-xl shadow-inner space-y-4 transition-colors duration-200">
        <div class="space-y-1">
          <label class="block text-xs font-semibold tb-label-muted">Amount You Get ($)</label>
          <input id="amtSlider" type="range" min="5000" max="1000000" step="1000" class="tb-slider" />
          <div class="relative group">
            <span class="absolute left-3 input-icon tb-label-muted text-sm">$</span>
            <input id="amtInput" inputmode="numeric" class="tb-input w-full p-1.5 pl-8 text-sm border rounded-lg shadow-sm" />
          </div>
        </div>

        <div class="space-y-1">
          <label class="block text-xs font-semibold tb-label-muted">Factor Rate</label>
          <input id="factorSlider" type="range" min="1.1" max="1.6" step="0.01" class="tb-slider" />
          <div class="relative group">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 absolute left-3 input-icon tb-label-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
            </svg>
            <input id="factorInput" type="number" step="0.01" class="tb-input w-full p-1.5 pl-9 text-sm border rounded-lg shadow-sm" />
          </div>
        </div>

        <div class="space-y-1">
          <label class="block text-xs font-semibold tb-label-muted">Term Length (Months)</label>
          <input id="termSlider" type="range" min="1" max="36" step="1" class="tb-slider" />
          <div class="relative group">
            <svg xmlns="http://www.w3.org/0/svg" class="h-4 w-4 absolute left-3 input-icon tb-label-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z"/>
            </svg>
            <input id="termInput" type="number" step="1" class="tb-input w-full p-1.5 pl-9 text-sm border rounded-lg shadow-sm" />
          </div>
        </div>
      </div>

      <!-- Term Unit toggle -->
      <div class="flex items-center justify-center space-x-2">
        <button id="termDailyBtn"   class="tb-pill text-xs font-semibold px-3 py-1.5 rounded-lg border">Daily</button>
        <button id="termWeeklyBtn"  class="tb-pill text-xs font-semibold px-3 py-1.5 rounded-lg border">Weekly</button>
        <button id="termMonthlyBtn" class="tb-pill text-xs font-semibold px-3 py-1.5 rounded-lg border">Monthly</button>
      </div>

      <!-- SUMMARY CARD -->
      <div id="summaryCard" class="tb-card border p-4 rounded-lg shadow-md space-y-6 transition-colors duration-200">
        <h4 class="text-base font-semibold text-center border-b border-slate-700/10 pb-2">
          Congratulations! You're Approved!
        </h4>
        <div class="text-center">
          <span class="text-sm font-semibold tb-label-muted block">You Get</span>
          <span id="sumAmt" class="tb-hero text-5xl font-semibold text-shadow-cyan block my-1"></span>
          <span class="text-lg font-medium tb-label-muted block">Total Payback: <span id="sumPay" class="font-semibold"></span></span>
        </div>
        <div>
          <h5 class="text-sm font-semibold mb-3 text-center">Offer Details</h5>
          <div class="grid grid-cols-2 gap-4 pt-4 border-t border-slate-700/10 text-sm">
            <!-- Factor Rate -->
            <div class="text-center space-y-0.5">
              <span class="text-[11px] tracking-wide uppercase tb-label-muted block">Factor Rate</span>
              <span id="sumFactor" class="text-sm font-normal"></span>
            </div>
            <!-- Term Length -->
            <div class="text-center space-y-0.5">
              <span class="text-[11px] tracking-wide uppercase tb-label-muted block">Term Length</span>
              <span id="sumTerm" class="text-sm font-normal"></span>
            </div>
            <!-- Payment -->
            <div class="text-center space-y-0.5">
              <span id="sumPayLabel" class="text-[11px] tracking-wide uppercase tb-label-muted block">Payment</span>
              <span id="sumPayVal" class="text-sm font-normal"></span>
            </div>
            <!-- # of Payments -->
            <div class="text-center space-y-0.5">
              <span class="text-[11px] tracking-wide uppercase tb-label-muted block"># of Payments</span>
              <span id="sumPaymentCount" class="text-sm font-normal"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const $ = id => document.getElementById(id);

      const appShell = $("appShell");

      const amtSlider    = $("amtSlider"),    amtInput    = $("amtInput");
      const factorSlider = $("factorSlider"), factorInput = $("factorInput");
      const termSlider   = $("termSlider"),   termInput   = $("termInput");

      const termDailyBtn   = $("termDailyBtn");
      const termWeeklyBtn  = $("termWeeklyBtn");
      const termMonthlyBtn = $("termMonthlyBtn");

      const sumAmt = $("sumAmt"), sumPay = $("sumPay"), sumFactor = $("sumFactor"),
            sumTerm = $("sumTerm"), sumPayLabel = $("sumPayLabel"),
            sumPayVal = $("sumPayVal"), sumPaymentCount = $("sumPaymentCount");

      const modeSelect   = $("modeSelect");
      const accentSelect = $("accentSelect");
      const shareBtn     = $("shareBtn");

      let termUnit = "daily";

      const toNum = v => {
        const n = parseFloat(v);
        return isNaN(n) ? 0 : n;
      };

      const fmtMoney = v => new Intl.NumberFormat("en-US", {
        style: "currency",
        currency: "USD",
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      }).format(toNum(v));

      const ACCENTS = {
        cyan:    "#0ea5e9",
        indigo:  "#6366f1",
        emerald: "#10b981",
        blue:    "#2563eb",
        violet:  "#7c3aed",
        rose:    "#f43f5e",
        amber:   "#f59e0b",
        teal:    "#14b8a6",
        lime:    "#84cc16",
        neutral: "#0f172a"
      };

      function applyMode(mode) {
        document.body.setAttribute("data-mode", mode);
        updateSummary();
      }

      function applyAccent(accentKey) {
        const color = ACCENTS[accentKey] || ACCENTS.blue;
        document.documentElement.style.setProperty("--tb-accent", color);
        updateSummary();
      }

      function setTermUnit(unit) {
        termUnit = unit;
        [termDailyBtn, termWeeklyBtn, termMonthlyBtn].forEach(btn => {
          if (!btn) return;
          btn.classList.remove("tb-pill-active");
        });
        if (unit === "daily"   && termDailyBtn)   termDailyBtn.classList.add("tb-pill-active");
        if (unit === "weekly"  && termWeeklyBtn)  termWeeklyBtn.classList.add("tb-pill-active");
        if (unit === "monthly" && termMonthlyBtn) termMonthlyBtn.classList.add("tb-pill-active");
        updateSummary();
      }

      function wireSlider(slider, input, min, max) {
        if (!slider || !input) return;
        const clamp = v => {
          if (isNaN(v)) v = min;
          if (v < min) v = min;
          if (v > max) v = max;
          return v;
        };

        slider.addEventListener("input", e => {
          let v = clamp(parseFloat(e.target.value));
          slider.value = v;
          input.value = String(v);
          updateSummary();
        });

        input.addEventListener("input", e => {
          if (e.target.value === "") return;
          let v = clamp(toNum(e.target.value));
          slider.value = v;
          input.value = String(v);
          updateSummary();
        });

        input.addEventListener("blur", () => {
          let v = clamp(toNum(input.value));
          slider.value = v;
          input.value = String(v);
          updateSummary();
        });
      }

      function updateSummary() {
        const amt    = toNum(amtInput && amtInput.value);
        const factor = toNum(factorInput && factorInput.value);
        const months = Math.max(1, toNum(termInput && termInput.value));

        const payback = amt * factor;

        let paymentCount = months;
        let paymentLabel = "";

        if (termUnit === "daily") {
          paymentLabel = "Daily Payment";
          paymentCount = months * 22;
        } else if (termUnit === "weekly") {
          paymentLabel = "Weekly Payment";
          paymentCount = months * 4.33;
        } else {
          paymentLabel = "Monthly Payment";
          paymentCount = months;
        }

        const payment = paymentCount > 0 ? payback / paymentCount : 0;

        if (sumAmt)         sumAmt.textContent         = fmtMoney(amt);
        if (sumPay)         sumPay.textContent         = fmtMoney(payback);
        if (sumFactor)      sumFactor.textContent      = factor.toFixed(2) + "x";
        if (sumTerm)        sumTerm.textContent        = `${months.toFixed(0)} months`;
        if (sumPayLabel)    sumPayLabel.textContent    = paymentLabel;
        if (sumPayVal)      sumPayVal.textContent      = fmtMoney(payment);
        if (sumPaymentCount)sumPaymentCount.textContent= Math.round(paymentCount).toString();
      }

      // Share as PNG of the themed presentation, named "approval"
      async function shareOffer() {
        if (!appShell || !window.html2canvas) {
          alert("Snapshot sharing is not available in this preview.");
          return;
        }
        try {
          const canvas = await html2canvas(appShell, {
            backgroundColor: null,
            scale: window.devicePixelRatio || 2
          });
          const dataURL = canvas.toDataURL("image/png");
          const link = document.createElement("a");
          link.href = dataURL;
          link.download = "approval.png";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        } catch (err) {
          console.error("Error generating snapshot:", err);
          alert("Unable to generate snapshot in this environment.");
        }
      }

      // Wire sliders
      wireSlider(amtSlider,    amtInput,    5000, 1000000);
      wireSlider(factorSlider, factorInput, 1.1,  1.6);
      wireSlider(termSlider,   termInput,   1,    36);

      // Term unit buttons
      if (termDailyBtn)   termDailyBtn.addEventListener("click",   () => setTermUnit("daily"));
      if (termWeeklyBtn)  termWeeklyBtn.addEventListener("click",  () => setTermUnit("weekly"));
      if (termMonthlyBtn) termMonthlyBtn.addEventListener("click", () => setTermUnit("monthly"));

      // Mode + accent controls
      if (modeSelect)   modeSelect.addEventListener("change", e => applyMode(e.target.value));
      if (accentSelect) accentSelect.addEventListener("change", e => applyAccent(e.target.value));

      // Share button (download PNG snapshot)
      if (shareBtn) shareBtn.addEventListener("click", shareOffer);

      // Initialize defaults: *light blue* theme
      amtSlider.value    = 50000; amtInput.value    = "50000";
      factorSlider.value = 1.32;  factorInput.value = "1.32";
      termSlider.value   = 12;    termInput.value   = "12";

      applyMode("light");
      applyAccent("blue");
      setTermUnit("daily");
    });
  </script>
</body>
</html>
