<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Live AI Business Report â€” TrustBureau.ai</title>

Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <script>
Â  Â  tailwind.config = {
Â  Â  Â  theme: {
Â  Â  Â  Â  extend: {
Â  Â  Â  Â  Â  fontFamily: {
Â  Â  Â  Â  Â  Â  heading: ['Plus Jakarta Sans', 'system-ui', 'sans-serif'],
Â  Â  Â  Â  Â  Â  sans: ['Inter', 'system-ui', 'sans-serif'],
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  colors: {
Â  Â  Â  Â  Â  Â  'brand-green': '#00C09A',
Â  Â  Â  Â  Â  Â  'brand-dark':Â  '#101418',
Â  Â  Â  Â  Â  Â  'brand-gray':Â  '#6B7280',
Â  Â  Â  Â  Â  Â  'brand-light': '#F8F9FA',
Â  Â  Â  Â  Â  Â  'brand-border':'#E5E7EB',
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  boxShadow: { card: '0 10px 24px rgba(0,0,0,.06)' }
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  </script>

Â  Â  <link rel="preconnect" href="https://fonts.googleapis.com"/>
Â  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@700;800&display=swap" rel="stylesheet"/>

Â  <style>
Â  Â  html { scroll-behavior: smooth; }
Â  Â  body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; background:white; }

Â  Â  .widget-card{border:1px solid #E5E7EB;border-radius:.75rem;background:#fff;box-shadow:0 10px 20px rgba(0,0,0,.06)}
Â  Â  .cta-button { transition: all .25s ease; }
Â  Â  .cta-button:hover { transform: translateY(-1px); box-shadow:0 12px 20px rgba(0,192,154,.15); }
Â  Â  .cta-disabled { opacity:.6; cursor:not-allowed; transform:none; box-shadow:none; }

Â  Â  .score-circle{width:120px;height:120px;border-radius:9999px;display:flex;align-items:center;justify-content:center;font-family:'Plus Jakarta Sans',sans-serif;font-weight:800;font-size:2.25rem;border:8px solid}
Â  Â  .score-red{border-color:#FECACA;color:#DC2626;background:#FEF2F2}
Â  Â  .score-yellow{border-color:#FDE68A;color:#D97706;background:#FFFBEB}
Â  Â  .score-green{border-color:#A7F3D0;color:#059669;background:#ECFDF5}

Â  Â  .step-icon{display:inline-flex;align-items:center;justify-content:center;width:1.1rem;height:1.1rem;border-radius:9999px;background:#E5E7EB;color:#fff;flex:none;margin-top:.2rem}
Â  Â  .step-icon.done{background:#059669}
Â  Â  .step-icon>svg{width:.7rem;height:.7rem;display:none}
Â  Â  .step-icon.done>svg{display:block}
Â  Â  .loader-bar{height:.5rem;border-radius:9999px;background:#E5E7EB;overflow:hidden}
Â  Â  .loader-bar>span{display:block;height:100%;background:#00C09A;width:6%;transition:width .6s ease}

Â  Â  .radar { width:72px;height:72px;border-radius:9999px;position:relative;border:2px solid #E5E7EB;overflow:hidden;
Â  Â  Â  background: radial-gradient(closest-side, rgba(0,192,154,.12), transparent 70%),
Â  Â  Â  Â  Â  Â  Â  Â  Â  conic-gradient(from 0deg, rgba(0,192,154,0) 0deg, rgba(0,192,154,.35) 35deg, rgba(0,192,154,0) 36deg);
Â  Â  Â  animation: radar-spin 1.5s linear infinite; }
Â  Â  .radar::before{content:"";position:absolute;inset:10%;border-radius:9999px;box-shadow:0 0 0 1px rgba(0,192,154,.12) inset,0 0 0 22px rgba(0,192,154,.06) inset}
Â  Â  @keyframes radar-spin { to { transform: rotate(360deg); } }

Â  Â  @keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }
Â  Â  .shimmer { background: linear-gradient(100deg,#F3F4F6 40%,#E5E7EB 50%,#F3F4F6 60%); background-size:200% 100%; animation:shimmer 1.15s ease-in-out infinite; }

Â  Â  .map-grid {
Â  Â  Â  background-image:
Â  Â  Â  Â  linear-gradient(to right, rgba(17,24,39,.06) 1px, transparent 1px),
Â  Â  Â  Â  linear-gradient(to bottom, rgba(17,24,39,.06) 1px, transparent 1px);
Â  Â  Â  background-size: 24px 24px;
Â  Â  }

Â  Â  /* Dev error panel */
Â  Â  #dev-error {
Â  Â  Â  position: fixed; bottom: 12px; right: 12px; z-index: 9999;
Â  Â  Â  max-width: 80vw; background: #111827; color: #fff; font-size: 12px;
Â  Â  Â  border-radius: 8px; border: 1px solid #374151; padding: 10px 12px;
Â  Â  Â  box-shadow: 0 10px 24px rgba(0,0,0,.3); display: none;
Â  Â  }
Â  Â  #dev-error b { color: #FBBF24; }
Â  Â  #dev-error a { color: #34D399; text-decoration: underline; }
Â  </style>
</head>

<body class="font-sans text-brand-dark">
Â  <noscript>
Â  Â  <div style="padding:12px;background:#FFFBEB;border-bottom:1px solid #FDE68A;text-align:center">
Â  Â  Â  JavaScript is disabled, so the report canâ€™t run. Enable JS and reload.
Â  Â  </div>
Â  </noscript>

Â  Â  <div id="dev-error"></div>
Â  <script>
Â  Â  (function(){
Â  Â  Â  const box = document.getElementById('dev-error');
Â  Â  Â  const show = (msg) => {
Â  Â  Â  Â  box.style.display = 'block';
Â  Â  Â  Â  const pre = document.createElement('pre');
Â  Â  Â  Â  pre.style.whiteSpace = 'pre-wrap';
Â  Â  Â  Â  pre.style.margin = '4px 0 0';
Â  Â  Â  Â  pre.textContent = msg;
Â  Â  Â  Â  if (!box.firstChild) {
Â  Â  Â  Â  Â  const h = document.createElement('div');
Â  Â  Â  Â  Â  h.innerHTML = '<b>Script error</b> â€” see console for details.';
Â  Â  Â  Â  Â  box.appendChild(h);
Â  Â  Â  Â  }
Â  Â  Â  Â  box.appendChild(pre);
Â  Â  Â  };
Â  Â  Â  window.addEventListener('error', (e) => show(`${e.message}Â  @ ${e.filename}:${e.lineno}:${e.colno}`));
Â  Â  Â  window.addEventListener('unhandledrejection', (e) => show(`Unhandled rejection: ${e.reason && e.reason.message ? e.reason.message : String(e.reason)}`));
Â  Â  })();
Â  </script>

Â  Â  <header class="bg-white/80 border-b border-brand-border sticky top-0 z-50 backdrop-blur-md">
Â  Â  <nav class="max-w-6xl mx-auto px-4 md:px-6 py-4 flex items-center justify-between">
Â  Â  Â  <a href="#" class="flex items-center gap-2.5">
Â  Â  Â  Â  <svg width="34" height="34" viewBox="0 0 50 50" fill="none" aria-hidden="true">
Â  Â  Â  Â  Â  <path d="M25 5L42.5 12.5V27.5C42.5 37.5 25 45 25 45C25 45 7.5 37.5 7.5 27.5V12.5L25 5Z" fill="#00C09A"/>
Â  Â  Â  Â  Â  <path d="M17.5 25L22.5 30L32.5 20" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
Â  Â  Â  Â  </svg>
Â  Â  Â  Â  <span class="font-heading text-xl md:text-2xl font-extrabold">TrustBureau.ai</span>
Â  Â  Â  </a>
Â  Â  Â  <div class="flex items-center gap-4">
Â  Â  Â  Â  <a href="/index.html" class="inline-flex items-center gap-2 text-sm md:text-base font-medium text-brand-dark hover:text-brand-green transition-colors">
Â  Â  Â  Â  Â  <span aria-hidden="true">â†</span> Back to Main
Â  Â  Â  Â  </a>
Â  Â  Â  Â  <button id="settings-btn" title="Settings" class="text-brand-gray hover:text-brand-dark transition-colors">
Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  </button>
Â  Â  Â  </div>
Â  Â  </nav>
Â  </header>

Â  Â  <section class="max-w-6xl mx-auto px-4 md:px-6 py-10 md:py-14">
Â  Â  <div class="max-w-3xl mx-auto text-center">
Â  Â  Â  <h1 class="font-heading text-4xl md:text-6xl font-extrabold leading-tight">Live AI Business Report</h1>
Â  Â  Â  <p class="text-brand-gray mt-3 md:mt-4">Search a <span class="font-semibold">US company</span>. The full report renders below.</p>

Â  Â  Â  <div class="widget-card mt-7 p-4">
Â  Â  Â  Â  <form id="search-form" class="w-full flex flex-col sm:flex-row gap-3 justify-center" autocomplete="off">
Â  Â  Â  Â  Â  <input id="business-name" type="text" placeholder="e.g., Tesla, Inc.; Taco Bell Corp.; Aquamark.io"
Â  Â  Â  Â  Â  Â  Â  Â  Â class="flex-1 px-4 py-3 border border-brand-border rounded-lg placeholder-gray-500 focus:outline-none focus:ring-brand-green focus:border-brand-green" />
Â  Â  Â  Â  Â  <button id="generate-report-btn" type="submit"
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="inline-flex items-center justify-center gap-2 bg-brand-green text-white font-bold rounded-lg px-5 py-3 text-lg cta-button">
Â  Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
Â  Â  Â  Â  Â  Â  Â  <path d="M17.293 15.707a1 1 0 00-1.414-1.414l-3.04-3.04A7 7 0 109 16a6.96 6.96 0 004.253-1.469l3.04 3.04a1 1 0 001.414-1.414zM9 14a5 5 0 110-10 5 5 0 010 10z"/>
Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Generate
Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </form>
Â  Â  Â  Â  <p class="text-xs text-gray-500 mt-2">Tip: Use the legal name for better Secretaryâ€‘ofâ€‘State matching.</p>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  Â  <section id="results" class="max-w-6xl mx-auto px-4 md:px-6 pb-16">
Â  Â  <div id="report-results-container" class="max-w-6xl mx-auto" style="display:none;">
Â  Â  Â  Â  Â  Â  <div id="report-loader" style="display:none;" class="widget-card p-6 md:p-8 space-y-6" role="status" aria-live="polite" aria-busy="true">
Â  Â  Â  Â  <div class="flex items-center gap-5">
Â  Â  Â  Â  Â  <div class="radar" aria-hidden="true"></div>
Â  Â  Â  Â  Â  <div class="flex-1">
Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between mb-2">
Â  Â  Â  Â  Â  Â  Â  <div class="font-heading font-semibold">Building your reportâ€¦</div>
Â  Â  Â  Â  Â  Â  Â  <div id="loader-timer" class="text-xs text-gray-500">00:00</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="loader-bar"><span id="loader-bar" style="width:6%"></span></div>
Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-500 mt-2">Scanning public data and synthesizing a complete snapshot.</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <ol id="loader-steps" class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"></ol>

Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
Â  Â  Â  Â  Â  <div class="skeleton-card space-y-3">
Â  Â  Â  Â  Â  Â  <div class="w-28 h-3 rounded shimmer"></div>
Â  Â  Â  Â  Â  Â  <div class="w-full h-20 shimmer rounded-md"></div>
Â  Â  Â  Â  Â  Â  <div class="w-3/4 h-3 rounded shimmer"></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="skeleton-card space-y-3">
Â  Â  Â  Â  Â  Â  <div class="w-32 h-3 rounded shimmer"></div>
Â  Â  Â  Â  Â  Â  <div class="w-full h-20 shimmer rounded-md"></div>
D; Â  Â  Â  Â  <div class="w-1/2 h-3 rounded shimmer"></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="skeleton-card space-y-3">
Â  Â  Â  Â  Â  Â  <div class="w-36 h-3 rounded shimmer"></div>
Â  Â  Â  Â  Â  Â  <div class="w-full h-20 shimmer rounded-md"></div>
Â  Â  Â  Â  Â  Â  <div class="w-5/6 h-3 rounded shimmer"></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="report-error-container" style="display:none;" class="widget-card p-6 border-red-200 bg-red-50">
Â  Â  Â  Â  <p id="report-error-message" class="text-sm text-red-700"></p>
Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="report-content" style="display:none;" class="space-y-8">
Â  Â  Â  Â  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <h2 id="report-title" class="font-heading text-2xl md:text-3xl font-extrabold"></h2>
Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-500 mt-1">Live business verification snapshot</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="flex items-center gap-3">
Â  Â  Â  Â  Â  Â  <button id="rerun" class="inline-flex items-center justify-center gap-2 bg-brand-green text-white font-bold rounded-lg px-4 py-2 cta-button">Reâ€‘run</button>
Â  Â  Â  Â  Â  Â  <button id="share-btn" class="inline-flex items-center justify-center gap-2 bg-gray-200 text-brand-dark font-bold rounded-lg px-4 py-2 cta-button">Share</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">AI Risk Score</h3>
Â  Â  Â  Â  Â  Â  <div class="flex flex-col items-center">
Â  Â  Â  Â  Â  Â  Â  <div id="report-score-circle" class="score-circle mb-4"><span id="report-score-digit">â€”</span></div>
Â  Â  Â  Â  Â  Â  Â  <p id="report-score-justification" class="text-center text-gray-600 text-sm mb-3 italic"></p>
Â  Â  Â  Â  Â  Â  Â  <div class="w-full text-left">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="text-xs font-semibold uppercase text-gray-500 mb-2">Key Positives</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <ul id="report-score-positives" class="space-y-1.5 mb-3"></ul>
Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="text-xs font-semibold uppercase text-gray-500 mb-2">Key Risks</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <ul id="report-score-negatives" class="space-y-1.5"></ul>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="lg:col-span-2 widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Business Summary</h3>
Â  Â  Â  Â  Â  Â  <p id="report-summary" class="text-sm text-gray-800 leading-relaxed"></p>

Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="p-4 border border-brand-border rounded-lg bg-brand-light">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="text-sm font-semibold text-brand-dark mb-3">Corporate Filings</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <ul class="text-sm text-gray-800 space-y-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Entity Name:</span> <span id="report-sos-name" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Entity Type:</span> <span id="report-sos-entity" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Status:</span> <span id="report-sos-status" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Jurisdiction:</span> <span id="report-sos-jurisdiction" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Formation Date:</span> <span id="report-sos-date" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Registered Agent:</span> <span id="report-sos-agent" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  <div class="p-4 border border-brand-border rounded-lg bg-brand-light">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="text-sm font-semibold text-brand-dark mb-3">Operational Highlights</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <ul id="report-highlights" class="space-y-2 text-sm text-gray-800"></ul>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="md:col-span-2 p-4 border border-brand-border rounded-lg bg-white">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="text-sm font-semibold text-brand-dark">Recent Headlines</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="news-updated" class="text-xs text-gray-500"></span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <ul id="report-news-list" class="space-y-2"></ul>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Contact & Location</h3>
Â  Â  Â  Â  Â  Â  <ul class="text-sm text-gray-800 space-y-1">
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Phone:</span> <span id="contact-phone" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Email:</span> <span id="contact-email" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Address:</span> <span id="contact-address" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li class="mt-2"><a id="contact-maplink" class="text-brand-green hover:underline text-sm" target="_blank" rel="noopener">Open in Google Maps</a></li>
Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="widget-card p-0 md:p-0 overflow-hidden">
D; Â  Â  Â  Â  <div id="map-shell" class="relative w-full h-[260px] md:h-[300px]">
Â  Â  Â  Â  Â  Â  Â  <iframe id="map-iframe" title="Map" class="w-full h-full border-0" loading="lazy" referrerpolicy="no-referrer-when-downgrade" style="display:none;"></iframe>
Â  Â  Â  Â  Â  Â  Â  <div id="map-placeholder" class="map-grid absolute inset-0 flex items-center justify-center text-sm text-gray-500">
Â  Â  Â  Â  Â  Â  Â  Â  Map will appear here when a valid address is available.
Â  s; Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Company Facts</h3>
Â  Â  Â  Â  Â  Â  <ul class="text-sm text-gray-700 space-y-1">
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Founded:</span> <span id="facts-founded" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Headquarters:</span> <span id="facts-hq" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Employees:</span> <span id="facts-employees" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Industry:</span> <span id="facts-industry" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Ticker:</span> <span id="facts-ticker" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  Â  <li><span class="text-gray-500">Website:</span> <span id="facts-website" class="ml-1"></span></li>
Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Public Records</h3>
Â  Â  Â  Â  Â  Â  <ul id="report-records-list" class="space-y-2 list-disc list-inside text-sm text-gray-800 leading-relaxed"></ul>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Leadership</h3>
Â  Â  Â  Â  Â  Â  <ul id="report-leadership-list" class="space-y-2 text-sm text-gray-800"></ul>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Products & Services</h3>
Â  Â  Â  Â  Â  Â  <ul id="report-products-list" class="space-y-2 text-sm text-gray-800"></ul>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Competitors</h3>
Â  Â  Â  Â  Â  Â  <ul id="report-competitors-list" class="space-y-2 text-sm text-gray-800"></ul>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Web & Social Signals</h3>
Â  Â  Â  Â  Â  Â  <ul id="report-social-list" class="space-y-1.5 text-sm text-gray-800"></ul>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
Â  Â  Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Customer Reviews</h3>
Â  Â  Â  Â  Â  Â  <div id="report-reviews-list" class="space-y-3"></div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="widget-card p-5 md:p-6">
D; Â  Â  Â  Â  <h3 class="font-heading font-semibold mb-3">Financial Charts</h3>
Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 gap-4">
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <h5 class="text-sm font-medium text-brand-dark mb-1">Revenue Trend</h5>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="report-chart-revenue" class="h-24"></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <h5 class="text-sm font-medium text-brand-dark mb-1">Cash Flow</h5>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="report-chart-cashflow" class="h-24"></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="report-sources-container" class="widget-card p-5 md:p-6" style="display:none;">
Â  Â  Â  Â  Â  <div class="flex items-center justify-between">
Â  Â  Â  Â  Â  Â  <h4 class="text-xs font-semibold text-gray-500 uppercase">Sources & Links</h4>
Â  Â  Â  Â  Â  Â  <button id="toggle-sources" type="button" class="text-xs text-brand-green hover:underline">Hide list</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div id="report-sources-chips" class="flex flex-wrap gap-2 mt-3"></div>
Â  Â  Â  Â  Â  <ul id="report-sources" class="mt-4 space-y-1 list-disc list-inside"></ul>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <footer class="border-t border-brand-border">
Â  Â  <div class="max-w-6xl mx-auto px-4 md:px-6 py-10 text-center text-sm text-gray-500">
Â  Â  Â  Â© 2025 TrustBureau.ai â€” Live AI Business Report
Â  Â  </div>
Â  </footer>

Â  Â  <div id="settings-modal" class="fixed inset-0 bg-black/30 z-50 hidden items-center justify-center p-4">
Â  Â  <div class="widget-card w-full max-w-md p-6 relative">
Â  Â  Â  <button id="close-settings-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
Â  Â  Â  Â  </svg>
Â  Â  Â  </button>
Â  Â  Â  <h3 class="font-heading text-lg font-bold mb-4">Settings</h3>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="api-key-input" class="block text-sm font-medium text-gray-700 mb-1">Gemini API Key</label>
Â  Â  Â  Â  <input type="password" id="api-key-input" class="w-full px-3 py-2 border border-brand-border rounded-lg" placeholder="Enter your API key">
Â  Â  Â  Â  <p class="text-xs text-gray-500 mt-1">Your key is stored only in your browser's local storage.</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="mt-4 flex justify-end">
Â  Â  Â  Â  <button id="save-settings-btn" class="bg-brand-green text-white font-bold rounded-lg px-4 py-2 cta-button">Save</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  /* ===================== Config (v1beta + modern models; NO FAKE DATA) ===================== */
Â  Â  const zakk = "";Â  Â  Â  Â  Â  Â  Â  // or set window.zakk at runtime
Â  Â  const PROXY_BASE = "";Â  Â  Â  Â  // optional proxy base (must forward /v1beta unchanged)

Â  Â  const MODEL_CANDIDATES = [
Â  Â  Â  'gemini-2.5-flash',
Â  Â  Â  'gemini-2.5-flash-lite',
Â  Â  Â  'gemini-2.0-flash'
Â  Â  Â  // 'gemini-2.5-pro' // include if your key has access
Â  Â  ];
Â  Â  const DIRECT_BASE = 'https://generativelanguage.googleapis.com/v1beta/models';
Â  Â  const MAX_OUTPUT_TOKENS = 8192;

Â  Â  /* ===================== Utilities ===================== */
Â  Â  function getApiKey() {
Â  Â  Â  const fromStorage = localStorage.getItem('apiKey');
Â  Â  Â  if (fromStorage && fromStorage.trim()) return fromStorage.trim();
Â  Â  Â  const fromWindow = (typeof window !== 'undefined' && window.zakk) ? String(window.zakk).trim() : '';
Â  Â  Â  const fromConstÂ  = (typeof zakk !== 'undefined' && zakk) ? String(zakk).trim() : '';
Â  Â  Â  return fromWindow || fromConst || "";
Â  Â  }
Â  Â  function makeUrl(model) {
Â  Â  Â  if (PROXY_BASE) return `${PROXY_BASE}/v1beta/models/${model}:generateContent`;
Â  Â  Â  return `${DIRECT_BASE}/${model}:generateContent`;
Â  Â  }
Â  Â  function listModelsUrl() {
Â  Â  Â  if (PROXY_BASE) return `${PROXY_BASE}/v1beta/models`;
Â  Â  Â  return `https://generativelanguage.googleapis.com/v1beta/models`;
Â  Â  }
Â  Â  function setText(el, v){ el.textContent = (v ?? '') !== '' ? String(v) : 'N/A'; }
Â  Â  function toDomain(url) { try { return new URL(url).hostname.replace(/^www\./,''); } catch { return url; } }
Â  Â  function linkifyMaybe(v) {
Â  Â  Â  if (!v) return 'N/A';
Â  Â  Â  const s = String(v).trim();
Â  Â  Â  if (/^https?:\/\//i.test(s)) {
Â  Â  Â  Â  return `<a href="${s}" target="_blank" rel="noopener" class="text-brand-green hover:underline">${toDomain(s)}</a>`;
Â  Â  Â  }
Â  Â  Â  return s;
Â  Â  }
Â  Â  function renderLineChart(container, values, color) {
Â  Â  Â  if (!Array.isArray(values) || values.length < 2 || values.every(v => !Number.isFinite(+v))) {
Â  Â  Â  Â  container.innerHTML = '<p class="text-sm text-gray-700">Chart not available.</p>';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  const nums = values.map(v => Number.isFinite(+v) ? +v : 0);
Â  Â  Â  const min = Math.min(...nums), max = Math.max(...nums);
Â  Â  Â  if (!isFinite(min) || !isFinite(max) || max === min) {
Â  Â  Â  Â  container.innerHTML = '<p class="text-sm text-gray-700">Chart not available.</p>';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  const norm = nums.map(n => (100 * (n - min)) / (max - min));
Â  Â  Â  const step = 100 / (norm.length - 1);
Â  Â  Â  const pts = norm.map((v,i) => `${(i*step).toFixed(2)},${(50 - (v/100)*44 - 3).toFixed(2)}`).join(' ');
Â  Â  Â  container.innerHTML =
Â  Â  Â  Â  `<svg width="100%" height="100%" viewBox="0 0 100 50" preserveAspectRatio="none">
Â  Â  Â  Â  Â  <polyline fill="none" stroke="${color}" stroke-width="2" points="${pts}" />
Â  Â  Â  Â  Â  <line x1="0" y1="48" x2="100" y2="48" stroke="#E5E7EB" stroke-width="1" />
Â  Â  Â  Â  </svg>`;
Â  Â  }

Â  Â  /* ===================== Loader UI ===================== */
Â  Â  let __loaderCtl = null;
Â  Â  function startLoadingAnimation() {
Â  Â  Â  const steps = [
Â  Â  Â  Â  'Matching business identity (US bias)','Searching open web','Pulling SOS filings',
Â  Â  Â  Â  'Parsing metadata','Checking public records','Gathering leadership',
Â  Â  Â  Â  'Mapping products & services','Finding competitors','Collecting web & social',
Â  Â  Â  Â  'Crawling headlines','Reading customer reviews','Synthesizing risk score'
Â  Â  Â  ];
Â  Â  Â  const stepsOl = document.getElementById('loader-steps');
Â  Â  Â  const barElÂ  Â = document.getElementById('loader-bar');
Â  Â  Â  const timerEl = document.getElementById('loader-timer');

Â  Â  Â  stepsOl.innerHTML = steps.map((s,i) => `
Â  Â  Â  Â  <li class="flex items-start gap-2">
Â  Â  Â  Â  Â  <span class="step-icon" id="ld_${i}">
Â  Â  Â  Â  Â  Â  <svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
Â  Â  Â  Â  Â  Â  Â  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  <span>${s}</span>
Â  Â  Â  Â  </li>`).join('');

Â  Â  Â  let elapsed = 0;
Â  Â  Â  const tTimer = setInterval(() => {
Â  Â  Â  Â  elapsed += 200;
Â  Â  Â  Â  const m = Math.floor(elapsed/1000/60);
Â  Â  Â  Â  const s = Math.floor((elapsed/1000)%60);
Â  Â  Â  Â  timerEl.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
Â  Â  Â  }, 200);

Â  Â  Â  let idx = 0;
Â  Â  Â  const stepMs = Math.max(900, Math.floor(24000 / steps.length));
Â  Â  Â  const tSteps = setInterval(() => {
Â  Â  Â  Â  if (idx < steps.length) {
Â  Â  Â  Â  Â  document.getElementById(`ld_${idx}`)?.classList.add('done');
Â  Â  Â  Â  Â  idx++;
Â  Â  Â  Â  Â  const pct = Math.min(98, Math.round((idx/steps.length)*100 - 2));
Â  Â  Â  Â  Â  barEl.style.width = pct + '%';
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  const cur = parseFloat(barEl.style.width) || 98;
Â  Â  Â  Â  Â  barEl.style.width = Math.min(99, cur + 0.2) + '%';
Â  Â  Â  Â  }
Â  Â  Â  }, stepMs);

Â  Â  Â  return { stop(){ clearInterval(tSteps); clearInterval(tTimer); barEl.style.width = '100%'; } };
Â  Â  }

Â  Â  const results = document.getElementById('report-results-container');
Â  Â  const loaderÂ  = document.getElementById('report-loader');
Â  Â  const errBoxÂ  = document.getElementById('report-error-container');
Â  Â  const errMsgÂ  = document.getElementById('report-error-message');
Â  Â  const content = document.getElementById('report-content');

Â  Â  function showState(state, message = '') {
Â  Â  Â  loader.style.display = 'none';
Â  Â  Â  errBox.style.display = 'none';
Â  Â  Â  content.style.display = 'none';
Â  Â  Â  results.style.display = 'block';

Â  Â  Â  if (__loaderCtl) { __loaderCtl.stop(); __loaderCtl = null; }

Â  Â  Â  if (state === 'loading') {
Â  Â  Â  Â  loader.style.display = 'block';
Â  Â  Â  Â  __loaderCtl = startLoadingAnimation();
Â  Â  Â  } else if (state === 'error') {
Â  Â  Â  Â  errBox.style.display = 'block';
Â  Â  Â  Â  errMsg.textContent = message || 'Something went wrong.';
Â  Â  Â  } else if (state === 'content') {
Â  Â  Â  Â  content.style.display = 'block';
Â  Â  Â  }
Â  Â  }

Â  Â  /* ===================== JSON parsing (v1beta) ===================== */
Â  Â  function parseCandidateJSON(candidate) {
Â  Â  Â  const part = candidate?.content?.parts?.[0];
Â  Â  Â  if (part && part.text) {
Â  Â  Â  Â  try { return JSON.parse(part.text); } catch (e) {
Â  Â  Â  Â  Â  const raw = part.text.trim().replace(/```json/g, '```').replace(/```/g, '');
Â  Â  Â  Â  Â  try { return JSON.parse(raw); } catch {}
Â  Â  Â  Â  Â  const lastCurly = raw.lastIndexOf('}'), lastSquare = raw.lastIndexOf(']');
Â  Â  Â  Â  Â  const cut = Math.max(lastCurly, lastSquare);
Â  Â  Â  Â  Â  if (cut > 0) { try { return JSON.parse(raw.slice(0, cut + 1)); } catch {} }
Â  Â  Â  Â  Â  throw new Error(`Model returned unparseable JSON: ${e.message}`);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  for (const p of (candidate?.content?.parts || [])) {
Â  Â  Â  Â  if (p?.inline_data?.data && String(p.inline_data.mimeType || '').toLowerCase().includes('json')) {
Â  Â  Â  Â  Â  try { return JSON.parse(atob(p.inline_data.data)); } catch {}
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  throw new Error('Model returned no parseable JSON payload.');
Â  Â  }

Â  Â  /* ===================== Fetch helper ===================== */
Â  Â  async function fetchWithBackoff(url, options, retries = 2, delay = 900) {
Â  Â  Â  let lastError;
Â  Â  Â  for (let i = 0; i < retries; i++) {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const res = await fetch(url, options);
Â  Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  Â  let body=null; try { body = await res.json(); } catch {}
Â  Â  Â  Â  Â  Â  const msg = body?.error?.message || res.statusText || 'Request failed';
Â  Â  Â  Â  Â  Â  const err = new Error(`${msg} (HTTP ${res.status})`);
Â  Â  Â  Â  Â  Â  err.httpStatus = res.status;
Â  Â  Â  Â  Â  Â  err.code = body?.error?.status;
Â  Â  Â  Â  Â  Â  throw err;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  return await res.json();
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  lastError = e;
Â  Â  Â  Â  Â  if ((e.httpStatus && e.httpStatus < 500) || (e.code && String(e.code).startsWith('4'))) break;
Â  Â  Â  Â  Â  if (i < retries - 1) await new Promise(r => setTimeout(r, delay * Math.pow(2, i)));
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  throw lastError || new Error('API request failed.');
Â  Â  }

Â  Â  /* ===================== Model resolution ===================== */
Â  Â  const isRetired = (name) => /^gemini-(1(\.0|\.5)|0)\b/i.test(name);

Â  Â  async function resolveUsableModel(candidates, apiHeaders) {
Â  Â  Â  for (const m of candidates.filter(m => !isRetired(m))) {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const ping = await fetchWithBackoff(makeUrl(m), {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: apiHeaders,
Â  Â  Â  Â  Â  Â  body: JSON.stringify({ contents: [{ parts: [{ text: "ping" }] }] })
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  if (Array.isArray(ping?.candidates)) return m;
Â  Â  Â  Â  } catch (e) { /* try next */ }
Â  Â  Â  }
Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch(listModelsUrl(), { headers: apiHeaders });
Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  const models = data?.models || [];
Â  Â  Â  Â  const prefer = models.find(x => /gemini-2\.5-flash/i.test(x.name || x.baseModelId || ''));
Â  Â  Â  Â  if (prefer) return (prefer.baseModelId || prefer.name).replace(/^models\//,'');
Â  Â  Â  Â  const anyGC = models.find(x => (x.supportedGenerationMethods || []).includes('generateContent'));
Â  Â  Â  Â  if (anyGC) return (anyGC.baseModelId || anyGC.name).replace(/^models\//,'');
Â  Â  Â  } catch (e) { console.warn('Model listing failed:', e); }
Â  Â  Â  return 'gemini-2.5-flash';
Â  Â  }

Â  Â  /* ===================== API (v1beta, schema, grounding) ===================== */
Â  Â  const responseSchema = {
Â  Â  Â  type: "OBJECT",
Â  Â  Â  properties: {
Â  Â  Â  Â  summary: { type: "OBJECT", properties: { companyName: { type: "STRING" }, summary: { type: "STRING" } } },
Â  Â  Â  Â  sos: { type: "OBJECT", properties: { entityName: { type: "STRING" }, status: { type: "STRING" }, entityType: { type: "STRING" }, jurisdiction: { type: "STRING" }, formationDate: { type: "STRING" }, registeredAgent: { type: "STRING" }, principalAddress: { type: "STRING" } } },
Â  Â  Â  Â  publicRecords: { type: "OBJECT", properties: { findings: { type: "ARRAY", items: { type: "OBJECT", properties: { type: { type: "STRING" }, details: { type: "STRING" } } } } } },
Â  Â  Â  Â  riskScore: { type: "OBJECT", properties: { score: { type: "NUMBER" }, justification: { type: "STRING" }, positiveFactors: { type: "ARRAY", items: { type: "STRING" } }, negativeFactors: { type: "ARRAY", items: { type: "STRING" } } } },
Â  Â  Â  Â  reviews: { type: "ARRAY", items: { type: "OBJECT", properties: { snippet: { type: "STRING" }, source: { type: "STRING" }, url: { type: "STRING" } } } },
Â  Â  Â  Â  chartPoints: { type: "OBJECT", properties: { revenue: { type: "ARRAY", items: { type: "NUMBER" } }, cashFlow: { type: "ARRAY", items: { type: "NUMBER" } } } },
Â  Â  Â  Â  profile: { type: "OBJECT", properties: { founded: { type: "STRING" }, headquarters: { type: "STRING" }, employees: { type: "STRING" }, website: { type: "STRING" }, industry: { type: "STRING" }, subindustry: { type: "STRING" }, ticker: { type: "STRING" } } },
Â  Â  Â  Â  news: { type: "ARRAY", items: { type: "OBJECT", properties: { title: { type: "STRING" }, date: { type: "STRING" }, source: { type: "STRING" }, url: { type: "STRING" } } } },
Â  Â  Â  Â  leadership: { type: "ARRAY", items: { type: "OBJECT", properties: { name: { type: "STRING" }, title: { type: "STRING" }, linkedin: { type: "STRING" } } } },
Â  Â  Â  Â  products: { type: "ARRAY", items: { type: "STRING" } },
Â  Â  Â  Â  competitors: { type: "ARRAY", items: { type: "STRING" } },
Â  Â  Â  Â  webPresence: { type: "OBJECT", properties: { twitter: { type: "STRING" }, linkedin: { type: "STRING" }, youtube: { type: "STRING" }, traffic: { type: "STRING" } } },
Â  Â  Â  Â  contact: { type: "OBJECT", properties: { phone: { type: "STRING" }, email: { type: "STRING" }, address: { type: "STRING" }, lat: { type: "NUMBER" }, lng: { type: "NUMBER" }, mapsLink: { type: "STRING" } } },
Â  Â  Â  Â  highlights: { type: "ARRAY", items: { type: "STRING" } },
Â  Â  Â  Â  kpis: { type: "ARRAY", items: { type: "OBJECT", properties: { metric: { type: "STRING" }, q1: { type: "STRING" }, q2: { type: "STRING" }, q3: { type: "STRING" }, q4: { type: "STRING" }, yoy: { type: "STRING" } } } },
Â  Â  Â  Â  citations: { type: "ARRAY", items: { type: "OBJECT", properties: { title: { type: "STRING" }, url: { type: "STRING" } } } }
Â  Â  Â  }
Â  Â  };

Â  Â  function makePayload(systemPrompt, userQuery) {
Â  Â  Â  return {
Â  Â  Â  Â  contents: [{ role: 'user', parts: [{ text: userQuery }] }],
Â  Â  Â  Â  tools: [{ "google_search": {} }],
Â  Â  Â  Â  systemInstruction: { parts: [{ text: systemPrompt }] },
Â  Â  Â  Â  generationConfig: {
Â  Â  Â  Â  Â  maxOutputTokens: MAX_OUTPUT_TOKENS,
Â  Â  Â  Â  Â  temperature: 0.2,
Â  Â  Â  Â  Â  topP: 0.95
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  }

Â  Â  async function callReportAPI(systemPrompt, userQuery) {
Â  Â  Â  const key = getApiKey();
Â  Â  Â  if (!PROXY_BASE && !key) throw new Error('Missing API key. Open Settings (gear) and add a valid Gemini key.');

Â  Â  Â  const apiHeaders = { 'Content-Type': 'application/json' };
Â  Â  Â  if (key) apiHeaders['x-goog-api-key'] = key;

Â  Â  Â  const model = await resolveUsableModel(MODEL_CANDIDATES, apiHeaders);
Â  Â  Â  const url = makeUrl(model);
Â  Â  Â  const payload = makePayload(systemPrompt, userQuery);

Â  Â  Â  const data = await fetchWithBackoff(url, {
Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  headers: apiHeaders,
Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  });

Â  Â  Â  const cand = data?.candidates?.[0];
Â  Â  Â  if (!cand) {
Â  Â  Â  Â  if (data?.promptFeedback?.blockReason) throw new Error(`Request blocked: ${data.promptFeedback.blockReason}`);
Â  Â  Â  Â  throw new Error('No candidates in API response.');
Â  Â  Â  }
Â  Â  Â  if (cand.finishReason && cand.finishReason !== 'STOP') {
Â  Â  Â  Â  throw new Error(`Generation stopped: ${cand.finishReason}`);
Â  Â  Â  }

Â  Â  Â  const json = parseCandidateJSON(cand);

Â  Â  Â  let sources = [];
Â  Â  Â  const gm = cand.groundingMetadata;
Â  Â  Â  if (gm && gm.groundingAttributions) {
Â  Â  Â  Â  sources = gm.groundingAttributions
Â  Â  Â  Â  Â  .map(a => ({ uri: a.web?.uri, title: a.web?.title }))
Â  Â  Â  Â  Â  .filter(s => s.uri && s.title);
Â  Â  Â  }
Â  Â  Â  return { json, sources };
Â  Â  }

Â  Â  /* ===================== Prompt ===================== */
Â  Â  function buildSystemPrompt() {
Â  Â  Â  return `
You are a meticulous US-focused business analyst.
Constrain to the US when interpreting ambiguous names. Use "N/A" or [] when unknown.

Reviews: include 3â€“6 concise snippets (12â€“40 words) from US-centric sources with URLs (Google reviews, Yelp, Trustpilot, BBB, G2, Reddit, forums, reputable media).
Map rule: prefer the SOS principal/registered address; if unknown, use contact.address; then profile.headquarters.

Fill all fields in the provided JSON schema to the best of your ability using live search data.
You MUST return ONLY the JSON object, enclosed in \`\`\`json ... \`\`\` tags.
Â  Â  Â  `.trim();
Â  Â  }

Â  Â  /* ===================== Reviews booster (still real data via search/tooling) ===================== */
Â  Â  const reviewsSchema = {
Â  Â  Â  type: "OBJECT",
Â  Â  Â  properties: {
Â  Â  Â  Â  reviews: {
Â  Â  Â  Â  Â  type: "ARRAY",
Â  Â  Â  Â  Â  items: {
Â  Â  Â  Â  Â  Â  type: "OBJECT",
Â  Â  Â  Â  Â  Â  properties: {
Â  Â  Â  Â  Â  Â  Â  snippet: { type: "STRING" },
Â  Â  Â  Â  Â  Â  Â  source:Â  { type: "STRING" },
Â  Â  Â  Â  Â  Â  Â  url:Â  Â  Â { type: "STRING" }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  };

Â  Â  function reviewsNeeded(json) {
Â  Â  Â  const n = Array.isArray(json?.reviews) ? json.reviews.length : 0;
Â  Â  Â  return n < 2;
Â  Â  }

Â  Â  async function supplementReviews(companyName, baseJson) {
Â  Â  Â  const sys = `
You are a US-focused research assistant. Return ONLY a JSON object with a "reviews" array, enclosed in \`\`\`json ... \`\`\` tags.
Each review item must be: { "snippet": string (12â€“40 words), "source": string, "url": string }.
Collect 3â€“6 impartial snippets summarizing public sentiment from credible US sources (Google reviews, Yelp, Trustpilot, BBB, G2, Reddit, forums, reputable media).
Avoid duplicates; include direct URLs when possible. If nothing exists, return {"reviews": []}.
`.trim();

Â  Â  Â  const userQ = `Provide 5 review snippets for "${companyName}" as specified. US bias; business context only.`;
Â  Â  Â  try {
Â  Â  Â  Â  const key = getApiKey();
Â  Â  Â  Â  const apiHeaders = { 'Content-Type': 'application/json' };
Â  Â  Â  Â  if (key) apiHeaders['x-goog-api-key'] = key;

Â  Â  Â  Â  const model = await resolveUsableModel(MODEL_CANDIDATES, apiHeaders);
Â  Â  Â  Â  const url = makeUrl(model);
Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  contents: [{ role: 'user', parts: [{ text: userQ }] }],
Â  Â  Â  Â  Â  tools: [{ "google_search": {} }],
Â  Â  Â  Â  Â  systemInstruction: { parts: [{ text: sys }] },
Â  Â  Â  Â  Â  generationConfig: {
Â  Â  Â  Â  Â  Â  maxOutputTokens: 2048,
Â  Â  Â  Â  Â  Â  temperature: 0.2
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };

Â  Â  Â  Â  const data = await fetchWithBackoff(url, {
Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  headers: apiHeaders,
Â  Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  Â  });

Â  Â  Â  Â  const cand = data?.candidates?.[0];
Â  Â  Â  Â  if (!cand) throw new Error('No candidate in reviews booster.');
Â  Â  Â  Â  const json = parseCandidateJSON(cand);

Â  Â  Â  Â  const arr = json?.reviews;
Â  Â  Â  Â  if (Array.isArray(arr) && arr.length) {
Â  Â  Â  Â  Â  const existingSnippets = new Set((baseJson.reviews || []).map(r => r.snippet));
Â  Â  Â  Â  Â  const newReviews = arr.filter(r => r.snippet && !existingSnippets.has(r.snippet));
Â  Â  Â  Â  Â  baseJson.reviews = (baseJson.reviews || []).concat(newReviews).slice(0, 6);
Â  T; Â  Â  }
Â  Â  Â  } catch (_e) {
Â  Â  Â  Â  console.error("Reviews booster failed:", _e);
Â  Â  Â  }
Â  Â  Â  return baseJson;
Â  Â  }

Â  Â  /* ===================== Sources helpers ===================== */
Â  Â  function normalizeUrl(u) { try { const url = new URL(u); url.search=''; if (url.pathname!== '/' && url.pathname.endsWith('/')) url.pathname=url.pathname.slice(0,-1); return url.toString(); } catch { return null; } }
Â  Â  function prettyUrl(u) { try { const url = new URL(u); let out = url.hostname.replace(/^www\./,''); if (url.pathname && url.pathname !== '/') out += url.pathname; return out.length>60?out.slice(0,57)+'â€¦':out; } catch { return u; } }
Example Â  function collectSources(json, modelSources) {
Â  Â  Â  const out = [], push = (title, url, kind) => { const norm = normalizeUrl(url); if (!norm) return; out.push({ title: title || prettyUrl(norm), url: norm, kind }); };
Â  Â  Â  (modelSources || []).forEach(s => push(s.title || s.uri, s.uri, 'source'));
Â  Â  Â  (json?.citations || []).forEach(c => push(c.title || c.url, c.url, 'citation'));
Read Â  Â  if (json?.profile?.website) push('Official Website', json.profile.website, 'site');
Â  Â  Â  const w = json?.webPresence || {};
Â  Â  Â  if (w.twitter && /^https?:\/\//.test(w.twitter)) push('Twitter / X', w.twitter, 'social');
Â  Â  Â  if (w.linkedin && /^https?:\/\//.test(w.linkedin)) push('LinkedIn', w.linkedin, 'social');
Â  Â  Â  if (w.youtube && /^https?:\/\//.test(w.youtube)) push('YouTube', w.youtube, 'social');
Â  Â  Â  (json?.news || []).forEach(n => { if (n?.url) push(n.title || n.source || 'News', n.url, 'news'); });
Â  Â  Â  (json?.reviews || []).forEach(r => { if (r?.url) push(r.source || 'Review', r.url, 'review'); });

Â  Â  Â  const seen = new Set();
Â  Â  Â  return out.filter(({ url }) => !seen.has(url) && seen.add(url));
Â  Â  }
Â  Â  function populateSources(links) {
Â  Â  Â  const chips = document.getElementById('report-sources-chips');
Â  Â  Â  const ul = document.getElementById('report-sources');
Â  Â  Â  const box = document.getElementById('report-sources-container');
Â  Â  Â  chips.innerHTML = ''; ul.innerHTML = '';
Â  Â  Â  if (!Array.isArray(links) || links.length === 0) { box.style.display = 'none'; return; }
Â  Â  Â  box.style.display = 'block';
Â  Â  Â  links.forEach(({ url, title, kind }) => {
Â  Â  Â  Â  const emoji = kind === 'news' ? 'ğŸ“°' : kind === 'review' ? 'â­' : kind === 'social' ? 'ğŸ”—' : kind === 'site' ? 'ğŸ¢' : kind === 'citation' ? 'ğŸ“š' : 'ğŸ”—';
Â  Â  Â  Â  const span = document.createElement('span');
Â  Â  Â  Â  span.className = 'border border-brand-border rounded-full bg-brand-light px-2 py-1 text-xs';
Â  Â  Â  Â  span.innerHTML = `${emoji} <a href="${url}" target="_blank" rel="noopener" class="text-brand-green font-semibold hover:underline">${title || prettyUrl(url)}</a>`;
Â  Â  Â  Â  chips.appendChild(span);
Â  Â  Â  });
Â  Â  Â  links.forEach(({ url, title }) => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.className = 'text-sm';
Â  Â  Â  Â  li.innerHTML = `<a class="text-brand-green hover:underline" href="${url}" target="_blank" rel="noopener">${title || prettyUrl(url)}</a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xs text-gray-400 ml-1">(${prettyUrl(url)})</span>`;
Â  Â  Â  Â  ul.appendChild(li);
Â  Â  Â  });
Â  Â  Â  ul.classList.remove('hidden');
Â  Â  Â  let open = true;
Â  Â  Â  const toggle = document.getElementById('toggle-sources');
Â  Â  Â  toggle.textContent = 'Hide list';
Â  Â  Â  toggle.onclick = () => {
Â  Â  Â  Â  open = !open;
Â  Â  Â  Â  ul.classList.toggle('hidden', !open);
s; Â  Â  Â  toggle.textContent = open ? 'Hide list' : 'Show list';
Â  Â  Â  };
Â  Â  }

Â  Â  /* ===================== DOM refs ===================== */
Â  Â  const titleEl = document.getElementById('report-title');
Â  Â  const summaryEl = document.getElementById('report-summary');

Â  Â  const scoreCircle = document.getElementById('report-score-circle');
Â  Â  const scoreDigitÂ  = document.getElementById('report-score-digit');
Â  Â  const scoreJustÂ  Â = document.getElementById('report-score-justification');
Â  Â  const posListÂ  Â  Â = document.getElementById('report-score-positives');
Â  Â  const negListÂ  Â  Â = document.getElementById('report-score-negatives');

Â  Â  const sosName = document.getElementById('report-sos-name');
Â  Â  const sosStatus = document.getElementById('report-sos-status');
Â  Â  const sosEntity = document.getElementById('report-sos-entity');
Â  Â  const sosJurisÂ  = document.getElementById('report-sos-jurisdiction');
Â  Â  const sosDateÂ  Â = document.getElementById('report-sos-date');
Â  Â  const sosAgentÂ  = document.getElementById('report-sos-agent');

Â  Â  const factsFoundedÂ  Â = document.getElementById('facts-founded');
Â  Â  const factsHQÂ  Â  Â  Â  = document.getElementById('facts-hq');
Â  Â  const factsEmployees = document.getElementById('facts-employees');
Â  Â  const factsIndustryÂ  = document.getElementById('facts-industry');
Â  Â  const factsTickerÂ  Â  = document.getElementById('facts-ticker');
Â  Â  const factsWebsiteÂ  Â = document.getElementById('facts-website');

Â  Â  const highlightsList = document.getElementById('report-highlights');

Â  Â  const contactPhone = document.getElementById('contact-phone');
Â  Â  const contactEmail = document.getElementById('contact-email');
Â  Â  const contactAddrÂ  = document.getElementById('contact-address');
Â  Â  const contactMapÂ  Â = document.getElementById('contact-maplink');
Â  Â  const mapIframeÂ  Â  = document.getElementById('map-iframe');
Â  Â  const mapPhÂ  Â  Â  Â  = document.getElementById('map-placeholder');

Â  Â  const recListÂ  Â  = document.getElementById('report-records-list');
Â  Â  const reviewsList= document.getElementById('report-reviews-list');
s; Â  const leaderList = document.getElementById('report-leadership-list');
Â  Â  const productsList = document.getElementById('report-products-list');
Â  Â  const compListÂ  Â = document.getElementById('report-competitors-list');
Â  Â  const socialList = document.getElementById('report-social-list');

Â  Â  const newsRollÂ  Â = document.getElementById('report-news-list');
Â  Â  const newsUpdated= document.getElementById('news-updated');

Â  Â  const chartRevenue = document.getElementById('report-chart-revenue');
Â  Â  const chartCashÂ  Â  = document.getElementById('report-chart-cashflow');

Â  Â  function colorizeStatus(el, status) {
Â  Â  Â  const s = (status || '').toLowerCase();
Â  Â  Â  el.className = 'ml-1 font-medium';
Â  Â  Â  if (s.includes('active')) el.classList.add('text-green-600');
Â  Â  Â  else if (s && !s.includes('n/a')) el.classList.add('text-red-600');
Â  Â  }

Â  Â  function firstSOSAddress(sos) {
Â  Â  Â  if (!sos) return '';
Â  Â  Â  const candidates = [
Â  Â  Â  Â  sos.principalAddress,
Â  Â  Â  Â  sos.principalOfficeAddress,
Â  Â  Â  Â  sos.principalPlaceOfBusiness,
Â  Â  Â  Â  sos.registeredOffice,
Â  Â  Â  Â  sos.registeredAgentAddress,
Â  Â  Â  Â  sos.registeredAddress,
Â  Â  Â  Â  sos.mailingAddress,
Â  Â  Â  Â  sos.address
Â  Â  Â  ].filter(s => s && String(s).trim() && s.toLowerCase() !== 'n/a');
Â  Â  Â  return candidates[0] || '';
Â  Â  }

Â  Â  function setMapByAddress(addr) {
Â  Â  Â  if (!addr) {
Â  Â  Â  Â  mapIframe.style.display = 'none';
Â  Â  Â  Â  mapPh.style.display = 'flex';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  const embed = `https://www.google.com/maps?q=${encodeURIComponent(addr)}&output=embed`;
Â  Â  Â  mapIframe.src = embed;
Â  Â  Â  mapIframe.style.display = 'block';
Â  Â  Â  mapPh.style.display = 'none';
Â  Â  }

Â  Â  /* ===================== Populate Report ===================== */
Â  Â  function populateReport(data) {
Â  Â  Â  // Title & summary
Â  Â  Â  setText(titleEl, data?.summary?.companyName);
Â  Â  Â  summaryEl.textContent = data?.summary?.summary || 'Not available.';

Â  Â  Â  // Score
Â  Â  Â  const scoreVal = data?.riskScore?.score;
Â  Â  Â  const hasScore = typeof scoreVal === 'number' && Number.isFinite(scoreVal);
Â  Â  Â  scoreDigit.textContent = hasScore ? String(scoreVal) : 'N/A';
Â  Â  Â  scoreJust.textContent = data?.riskScore?.justification || 'Not available.';
Â  Â  Â  scoreCircle.className = 'score-circle mb-4';
Â  Â  Â  if (hasScore) {
Â  Â  Â  Â  if (scoreVal < 550) scoreCircle.classList.add('score-red');
Â  Â  Â  Â  else if (scoreVal < 700) scoreCircle.classList.add('score-yellow');
Â  Â  Â  Â  else scoreCircle.classList.add('score-green');
Â  Â  Â  }

Â  Â  Â  // Positives / Negatives
Â  Â  Â  posList.innerHTML = '';
Â  Â  Â  (data?.riskScore?.positiveFactors || []).forEach(f => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.className = 'flex items-start';
Â  Â  Â  Â  li.innerHTML = '<svg class="w-4 h-4 text-green-500 mr-2 mt-0.5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>' +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `<span class="text-sm text-brand-dark">${f}</span>`;
Â  Â  Â  Â  posList.appendChild(li);
Â  Â  Â  });
Â  Â  Â  if (!posList.children.length) posList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';

Â  Â  Â  negList.innerHTML = '';
Â  Â  Â  (data?.riskScore?.negativeFactors || []).forEach(f => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.className = 'flex items-start';
Â  Â  Â  Â  li.innerHTML = '<svg class="w-4 h-4 text-red-500 mr-2 mt-0.5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/></svg>' +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `<span class="text-sm text-brand-dark">${f}</span>`;
Â  Â  Â  Â  negList.appendChild(li);
Â  Â  Â  });
Â  Â  Â  if (!negList.children.length) negList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';

Â  Â  Â  // Filings
Â  Â  Â  const sos = data?.sos || {};
Â  Â  Â  setText(sosName,Â  sos.entityName);
Â  Â  Â  setText(sosEntity,sos.entityType);
Â  Â  Â  setText(sosStatus,sos.status);
Â  Â  Â  colorizeStatus(sosStatus, sos.status);
Â  Â  Â  setText(sosJuris, sos.jurisdiction);
Â  Â  Â  setText(sosDate,Â  sos.formationDate);
Â  Â  Â  setText(sosAgent, sos.registeredAgent);

Â  Â  Â  // Company facts
Â  Â  Â  const p = data?.profile || {};
Â  Â  Â  setText(factsFounded, p.founded);
Â  Â  Â  setText(factsHQ, p.headquarters || p.hq);
Â  Â  Â  setText(factsEmployees, p.employees);
Â  Â  Â  setText(factsIndustry, p.industry || p.subindustry);
Â  Â  Â  setText(factsTicker, p.ticker);
Â  Â  Â  if (p.website && /^https?:\/\//.test(p.website)) factsWebsite.innerHTML = linkifyMaybe(p.website); else setText(factsWebsite, p.website);

Â  Â  Â  // Highlights
Â  Â  Â  const highlights = (data?.highlights || []);
Â  Â  Â  if (!highlights.length) {
Â  Â  Â  Â  highlightsList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';
Â  Â  Â  } else {
Â  Â  Â  Â  highlightsList.innerHTML = '';
Â  Â  Â  Â  highlights.slice(0,8).forEach(t => { const li = document.createElement('li'); li.innerHTML = t; highlightsList.appendChild(li); });
Â  Â  Â  }

Â  Â  Â  // News
Â  Â  Â  newsRoll.innerHTML = '';
Â  Â  Â  const news = (data?.news || []).slice(0,8);
Â  Â  Â  if (news.length) {
Â  Â  Â  Â  newsUpdated.textContent = `${news.length} items`;
Â  Â  Â  Â  news.forEach(n => {
Â  Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  Â  const href = n.url && /^https?:\/\//.test(n.url) ? n.url : '#';
Â  Â  Â  Â  Â  const datÂ  = n.date ? ` â€¢ ${n.date}` : '';
Â  Â  Â  Â  Â  li.innerHTML =
Â  Â  Â  Â  Â  Â  `<a class="text-brand-dark hover:text-brand-green font-medium leading-tight" href="${href}" target="_blank" rel="noopener">${n.title || 'Untitled'}</a>
Â  Â  Â  Â  Â  Â  Â <div class="text-xs text-gray-500">${n.source || 'Source'}${dat}</div>`;
Â  Â  Â  Â  Â  newsRoll.appendChild(li);
Â  Â  Â  Â  });
Â  Â  Â  } else {
Â  Â  Â  Â  newsUpdated.textContent = '';
Â  Â  Â  Â  newsRoll.innerHTML = '<li class="text-sm text-gray-600">No recent headlines found.</li>';
image Â  Â  }

Â  Â  Â  // Contact + Map
Â  Â  Â  const c = data?.contact || {};
Â  Â  Â  const sosAddress = firstSOSAddress(sos);
Â  Â  Â  const bestAddress = sosAddress || c.address || p.headquarters || p.hq || '';
Â  Â  Â  setText(contactPhone, c.phone);
Â  Â  Â  setText(contactEmail, c.email);
Â  Â  Â  setText(contactAddr,Â  bestAddress || 'N/A');
Â  Â  Â  if (bestAddress) {
Â  Â  Â  Â  contactMap.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(bestAddress)}`;
Â  Â  Â  Â  contactMap.style.pointerEvents = 'auto';
Â  Â  Â  Â  setMapByAddress(bestAddress);
Â  Â  Â  } else {
Â  Â  Â  Â  contactMap.href = '#'; contactMap.style.pointerEvents = 'none'; setMapByAddress('');
Â  Â  Â  }

Â  Â  Â  // Public records
Â  Â  Â  recList.innerHTML = '';
Â  Â  Â  (data?.publicRecords?.findings || []).forEach(r => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.textContent = `${r.type || 'Record'}: ${r.details || ''}`;
Â  Â  Â  Â  recList.appendChild(li);
Â  Â  Â  });
Â  Â  Â  if (!recList.children.length) recList.innerHTML = '<li class="list-none text-sm text-gray-600">Not available.</li>';

Â  Â  Â  // Leadership
Â  Â  Â  leaderList.innerHTML = '';
Â  Â  Â  (data?.leadership || []).slice(0,8).forEach(l => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  const linked = l.linkedin && /^https?:\/\//.test(l.linkedin)
Â  Â  Â  Â  Â  ? ` â€” <a class="text-brand-green hover:underline" href="${l.linkedin}" target="_blank" rel="noopener">LinkedIn</a>` : '';
Â  Â  Â  Â  li.innerHTML = `<span class="font-medium text-brand-dark">${l.name || 'N/A'}</span> â€” <span class="text-gray-700">${l.title || ''}</span>${linked}`;
Â  Â  Â  Â  leaderList.appendChild(li);
Â  Answer Â  });
Â  Â  Â  if (!leaderList.children.length) leaderList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';

Â  Â  Â  // Products
Â  Â  Â  productsList.innerHTML = '';
Â  Â  Â  (data?.products || []).slice(0,12).forEach(t => { const li = document.createElement('li'); li.textContent = t; productsList.appendChild(li); });
Â  Â  Â  if (!productsList.children.length) productsList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';

Â  Â  Â  // Competitors
Â  Â  Â  compList.innerHTML = '';
Â  Â  Â  (data?.competitors || []).slice(0,12).forEach(cmp => { const li = document.createElement('li'); li.textContent = cmp; compList.appendChild(li); });
s; Â  Â  if (!compList.children.length) compList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';

Â  Â  Â  // Social presence
Â  Â  Â  socialList.innerHTML = '';
Â  Â  Â  const w = data?.webPresence || {};
Â  Â  Â  [['Website Traffic', w.traffic], ['Twitter/X', w.twitter], ['LinkedIn', w.linkedin], ['YouTube', w.youtube]].forEach(([k,v]) => {
s; Â  Â  Â  if (!v || String(v).toLowerCase() === 'n/a') return;
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  let valueHtml = v;
Â  Â  Â  Â  if (typeof v === 'string' && /^https?:\/\//.test(v)) {
Â  Â  Â  Â  Â  valueHtml = `<a href="${v}" target="_blank" rel="noopener" class="text-brand-green hover:underline">${toDomain(v)}</a>`;
Â  Â  Â  Â  }
Â  Â  Â  Â  li.innerHTML = `<span class="text-gray-500">${k}:</span> <span class="font-medium text-brand-dark">${valueHtml}</span>`;
Â  Â  Â  Â  socialList.appendChild(li);
Â  Â  Â  });
Â  Â  Â  if (!socialList.children.length) socialList.innerHTML = '<li class="text-sm text-gray-600">Not available.</li>';

Â  Â  Â  // Charts (NO fabricated values)
Â  Â  Â  const points = data?.chartPoints || {};
Â  Â  Â  renderLineChart(chartRevenue, points.revenue, '#00C09A');
Â  Â  Â  renderLineChart(chartCash, points.cashFlow, '#3B82F6');
Â  Â  }

Â  Â  /* ===================== Boot & Events ===================== */
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  const form = document.getElementById('search-form');
Â  Â  Â  const input = document.getElementById('business-name');
Â  Â  Â  const btn = document.getElementById('generate-report-btn');
Â  Â  Â  const rerunBtn = document.getElementById('rerun');
Â  Â  Â  const shareBtn = document.getElementById('share-btn');

Â  Â  Â  // Settings Modal
Â  Â  Â  const settingsModal = document.getElementById('settings-modal');
Â  Â  Â  const settingsBtn = document.getElementById('settings-btn');
Â  Â  Â  const closeSettingsBtn = document.getElementById('close-settings-btn');
Â  Â  Â  const saveSettingsBtn = document.getElementById('save-settings-btn');
Â  Â  Â  const apiKeyInput = document.getElementById('api-key-input');

Â  Â  Â  const openModal = () => {
Â  Â  Â  Â  apiKeyInput.value = getApiKey();
Â  Â  Â  Â  settingsModal.classList.remove('hidden');
s; Â  Â  Â  settingsModal.classList.add('flex');
Â  Â  Â  };
Â  Â  Â  const closeModal = () => {
Â  Â  Â  Â  settingsModal.classList.add('hidden');
Â  Â  Â  Â  settingsModal.classList.remove('flex');
Â  Â  Â  };

Â  Â  Â  settingsBtn.addEventListener('click', openModal);
Â  Â  Â  closeSettingsBtn.addEventListener('click', closeModal);
Â  Â  Â  settingsModal.addEventListener('click', (e) => { if (e.target === settingsModal) closeModal(); });

s; Â  Â  saveSettingsBtn.addEventListener('click', () => {
Â  Â  Â  Â  const key = apiKeyInput.value.trim();
Â  Â  Â  Â  if (key) { localStorage.setItem('apiKey', key); window.zakk = key; }
Â  Â  Â  Â  else { localStorage.removeItem('apiKey'); window.zakk = ''; }
Â  Â  Â  Â  closeModal();
Â  Â  Â  });

Â  Â  Â  async function runReport(query) {
Â  Â  Â  Â  document.getElementById('report-results-container').style.display = 'block';
document.getElementById('results')?.scrollIntoView({ behavior: 'smooth' });
Â  Â  Â  Â  showState('loading');
Â  Â  Â  Â  btn.classList.add('cta-disabled'); btn.disabled = true;

Â  Â  Â  Â  const systemPrompt = buildSystemPrompt();
Â  Â  Â  Â  const userQuery = `Generate a comprehensive US-focused AI business report for: "${query}"`;

Â  Â  Â  Â  // Hard requirement: never fabricate data; require valid key
Â  Â  Â  Â  if (!getApiKey()) {
Â  Â  Â  Â  Â  showState('error', 'Missing API key. Open the Settings (gear) and add a valid Gemini API key.');
Â  Â  Â  Â  Â  btn.disabled = false; btn.classList.remove('cta-disabled');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  let { json, sources } = await callReportAPI(systemPrompt, userQuery);
Â  Â  Â  Â  Â  if (reviewsNeeded(json)) {
Â  Â  Â  Â  Â  Â  json = await supplementReviews(json?.summary?.companyName || query, json);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  populateReport(json);
Â  Â  Â  Â  Â  const links = collectSources(json, sources);
s; Â  Â  Â  Â  populateSources(links);
Â  Â  Â  Â  Â  showState('content');
Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  Â  const keyRelated = /API key|401|403|PERMISSION/i.test(String(e));
Â  Â  Â  Â  Â  const corsHint = (!PROXY_BASE && /Failed to fetch|NetworkError|CORS/i.test(String(e)))
Â  Â  Â  Â  Â  Â  ? 'Network/CORS error. If opening the file directly, serve it (e.g., `python3 -m http.server`).'
S Â  Â  Â  Â  Â  : '';
Â  Â  Â  Â  Â  const keyHint = keyRelated ? 'API key invalid or lacks access. Verify billing and model access in Google AI Studio.' : '';
Â  Â  Â  Â  Â  const nfHintÂ  = /404|NOT_FOUND/i.test(String(e)) ? 'Model not found for this API version. The app autoâ€‘selects a supported model; try again.' : '';
Â  Â  Â  Â  Â  showState('error', keyHint || corsHint || nfHint || e.message || 'Failed to generate report.');
Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  btn.disabled = false; btn.classList.remove('cta-disabled');
Example Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  function handleSearch(query) {
Â  Â  Â  Â  if (!query) { showState('error', 'Please enter a business name.'); return; }
Â  Â  Â  Â  window.location.hash = encodeURIComponent(query);
Â  Â  Â  Â  runReport(query);
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  form.addEventListener('submit', (ev) => {
s; Â  Â  Â  ev.preventDefault();
Â  Â  Â  Â  const q = (input.value || '').trim();
Â  Â  Â  Â  handleSearch(q);
Â  s; Â  });

Â  Â  Â  rerunBtn?.addEventListener('click', () => {
Â  Â  Â  Â  const q = (input.value || '').trim();
Â  Â  Â  Â  handleSearch(q);
Â  Â  Â  });

Â  Â  Â  shareBtn?.addEventListener('click', () => {
Â  Â  Â  Â  const copyToClipboard = (text) => {
s; Â  Â  Â  Â  if (navigator.clipboard) { return navigator.clipboard.writeText(text); }
Â  Â  Â  Â  Â  return new Promise((resolve, reject) => {
Â  Â  Â  Â  Â  Â  const ta = document.createElement("textarea");
Â  Example Â  Â  Â  Â  ta.value = text; ta.style.position = "fixed"; ta.style.top = "0"; ta.style.left = "0"; ta.style.opacity = "0";
Â  Â  Â  Â  Â  Â  document.body.appendChild(ta); ta.focus(); ta.select();
Â  Â  Â  Â  Â  Â  try { document.execCommand('copy') ? resolve() : reject(new Error('Copy failed')); }
Â  Â  Â  Â  Â  Â  catch (err) { reject(err); }
Â  Â  Â  Â  Â  Â  document.body.removeChild(ta);
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  };
Â  Â  Â  Â  copyToClipboard(window.location.href).then(() => {
Example Â  Â  Â  Â  const originalText = shareBtn.textContent;
Â  Â  Â  Â  Â  shareBtn.textContent = 'Copied!';
Â  Â  Â  Â  s; Â  shareBtn.classList.add('bg-brand-green', 'text-white');
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  shareBtn.textContent = originalText;
Â  Â  Â  Â  Â  Â  shareBtn.classList.remove('bg-brand-green', 'text-white');
Â  Â  Â  Â  Â  }, 2000);
Â  Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  Â  console.error('Failed to copy URL: ', err);
S Â  Â  Â  Â  const originalText = shareBtn.textContent;
Â  Â  Â  Â  Â  shareBtn.textContent = 'Failed!';
Â  Â  Â  Â  Â  setTimeout(() => { shareBtn.textContent = originalText; }, 2000);
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  // Deep link
Â  Â  Â  if (window.location.hash) {
Â  Â  Â  Â  const queryFromHash = decodeURIComponent(window.location.hash.substring(1));
image Â  Â  Â  Â  if (queryFromHash) {
Â  Â  Â  Â  Â  document.getElementById('report-results-container').style.display = 'block';
Â  Â  Â  Â  Â  input.value = queryFromHash;
Â  Â  Â  Â  Â  runReport(queryFromHash);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  });
Â  </script>
</body>
</html>
