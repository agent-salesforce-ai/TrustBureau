<!DOCTYPE html>
<html lang="en" class="theme-trust accent-brand bg-default">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrustBureau.ai – Approval Calculator</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    /* Tailwind config using TrustBureau.ai brand tokens */
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            heading: ['Plus Jakarta Sans', 'sans-serif'],
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
          colors: {
            'brand-green': '#00C09A',
            'brand-dark':  '#1A1A1A',
            'brand-gray':  '#666666',
            'brand-light': '#F8F9FA',
            'brand-border':'#E5E7EB',
          }
        }
      }
    }
  </script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet" />

  <!-- Core theming + TrustBureau brand theme -->
  <style>
    :root {
      --accent-color: #00C09A;
      --accent-color-light: #22D3A6;
      --accent-color-dark: #007A63;
      --accent-shadow: 0 0 26px rgba(0, 192, 154, 0.5);

      --bg-body: #ffffff;
      --bg-card: #ffffff;
      --bg-card-inner: #F8F9FA;
      --bg-slider-track: #E5E7EB;
      --bg-input: #ffffff;
      --bg-toggle-inactive: #E5E7EB;

      --border-primary: #E5E7EB;
      --text-primary: #1A1A1A;
      --text-secondary: #111827;
      --text-muted: #666666;

      --shadow-soft: 0 10px 30px rgba(15, 23, 42, 0.08);
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background-color: var(--bg-body);
      color: var(--text-primary);
      transition: background-color 0.2s ease, color 0.2s ease;
    }

    /* Brand utility fallbacks (from trustbureau.ai) */
    .text-brand-dark  { color: #1A1A1A !important; }
    .text-brand-gray  { color: #666666 !important; }
    .text-brand-green { color: #00C09A !important; }
    .bg-brand-dark    { background-color: #1A1A1A !important; }
    .bg-brand-light   { background-color: #F8F9FA !important; }
    .bg-brand-green   { background-color: #00C09A !important; }
    .border-brand-border { border-color: #E5E7EB !important; }

    /* Trust theme */
    html.theme-trust {
      --bg-body: #FFFFFF;
      --bg-card: #FFFFFF;
      --bg-card-inner: #F8F9FA;
      --bg-slider-track: #E5E7EB;
      --bg-input: #FFFFFF;
      --bg-toggle-inactive: #E5E7EB;

      --border-primary: #E5E7EB;
      --text-primary: #1A1A1A;
      --text-secondary: #111827;
      --text-muted: #666666;

      --shadow-soft: 0 8px 26px rgba(15, 23, 42, 0.08);
    }

    /* A couple of alt themes (you can add back more if you want) */
    html.theme-dark {
      --bg-body: #020617;
      --bg-card: #020617;
      --bg-card-inner: #020617;
      --bg-slider-track: #1F2937;
      --bg-input: #020617;
      --bg-toggle-inactive: #111827;

      --border-primary: #1F2937;
      --text-primary: #F9FAFB;
      --text-secondary: #E5E7EB;
      --text-muted: #9CA3AF;

      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.8);
    }
    html.theme-dark body { background-color: var(--bg-body); }

    html.theme-black {
      --bg-body: #000000;
      --bg-card: #000000;
      --bg-card-inner: #000000;
      --bg-slider-track: #111111;
      --bg-input: #000000;
      --bg-toggle-inactive: #111111;

      --border-primary: #171717;
      --text-primary: #F9FAFB;
      --text-secondary: #E5E5E5;
      --text-muted: #9CA3AF;

      --accent-color: #FFFFFF;
      --accent-color-light: #E5E5E5;
      --accent-color-dark: #FFFFFF;
      --accent-shadow: 0 0 22px rgba(255, 255, 255, 0.65);
      --shadow-soft: 0 24px 60px rgba(0, 0, 0, 1);
    }
    html.theme-black body { background-color: var(--bg-body); }

    /* A couple of "fun" themes */
    html.theme-ocean {
      --bg-body:#020617;--bg-card:#020617;--bg-card-inner:#020617;--bg-slider-track:#0f172a;--bg-input:#020617;--bg-toggle-inactive:#0f172a;
      --border-primary:#0ea5e9;--text-primary:#e0f2fe;--text-secondary:#bae6fd;--text-muted:#7dd3fc;
      --accent-color:#0ea5e9;--accent-color-light:#38bdf8;--accent-color-dark:#0369a1;--accent-shadow:0 0 22px rgba(56,189,248,.7);
      --shadow-soft:0 18px 45px rgba(15,23,42,.75);
    }
    html.theme-ocean body{
      background:
        radial-gradient(circle at 0 0,rgba(14,165,233,.35),transparent 55%),
        radial-gradient(circle at 100% 100%,rgba(8,47,73,.8),#020617);
    }

    html.theme-neon{
      --bg-body:#020617;--bg-card:rgba(2,6,23,.96);--bg-card-inner:rgba(15,23,42,.96);--bg-slider-track:#0f172a;--bg-input:rgba(15,23,42,.96);--bg-toggle-inactive:#020617;
      --border-primary:#22d3ee;--text-primary:#e5f2ff;--text-secondary:#f9fafb;--text-muted:#a5b4fc;
      --accent-color:#22d3ee;--accent-color-light:#38bdf8;--accent-color-dark:#06b6d4;--accent-shadow:0 0 18px rgba(56,189,248,.9);
      --shadow-soft:0 20px 55px rgba(15,23,42,.95);
    }
    html.theme-neon body{
      background:
        radial-gradient(circle at 0 0,rgba(59,130,246,.5),transparent 55%),
        radial-gradient(circle at 100% 100%,rgba(236,72,153,.5),#020617);
    }

    /* Accent palettes */
    html.accent-brand {
      --accent-color: #00C09A;
      --accent-color-light: #22D3A6;
      --accent-color-dark: #007A63;
      --accent-shadow: 0 0 26px rgba(0, 192, 154, 0.5);
    }
    html.accent-gold {
      --accent-color: #f59e0b;
      --accent-color-light: #fbbf24;
      --accent-color-dark: #92400e;
      --accent-shadow: 0 0 26px rgba(245,158,11,.7);
    }
    html.accent-blue {
      --accent-color:#2563eb;--accent-color-light:#3b82f6;--accent-color-dark:#1d4ed8;
      --accent-shadow:0 0 22px rgba(37,99,235,.65);
    }
    html.accent-emerald {
      --accent-color:#10b981;--accent-color-light:#34d399;--accent-color-dark:#047857;
      --accent-shadow:0 0 22px rgba(16,185,129,.65);
    }
    html.accent-rainbow {
      --accent-color:#ec4899;--accent-color-light:#a855f7;--accent-color-dark:#22d3ee;
      --accent-shadow:0 0 28px rgba(236,72,153,.7);
    }
    html.accent-metallic {
      --accent-color:#9ca3af;--accent-color-light:#e5e7eb;--accent-color-dark:#4b5563;
      --accent-shadow:0 0 22px rgba(148,163,184,.7);
    }

    /* Background styles */
    html.bg-default body { background-color: var(--bg-body); }
    html.bg-soft body {
      background:
        radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.22), transparent 55%),
        linear-gradient(to bottom, #f9fafb, #e5e7eb);
    }
    html.bg-darkmesh body {
      background:
        radial-gradient(circle at 0 0, rgba(59,130,246,.4), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(16,185,129,.4), #020617);
    }
    html.bg-grid body::before {
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background-image:
        linear-gradient(to right, rgba(148,163,184,0.25) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(148,163,184,0.25) 1px, transparent 1px);
      background-size: 24px 24px;
      opacity:0.18;
      z-index:-1;
    }

    /* Generic components */
    .card-bg {
      background-color: var(--bg-card);
      border: 1px solid var(--border-primary);
      box-shadow: var(--shadow-soft);
      border-radius: 1rem;
    }
    .card-inner-bg {
      background-color: var(--bg-card-inner);
      border-radius: 0.75rem;
      border: 1px solid var(--border-primary);
    }

    .text-primary { color: var(--text-primary); }
    .text-secondary { color: var(--text-secondary); }
    .text-muted { color: var(--text-muted); }
    .border-primary { border-color: var(--border-primary); }

    .input-field {
      background-color: var(--bg-input);
      border-radius: 0.75rem;
      border: 1px solid var(--border-primary);
      color: var(--text-primary);
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background-color 0.15s ease;
    }
    .input-field::placeholder { color: var(--text-muted); opacity: 0.7; }
    .input-field:focus,
    .input-field:focus-within {
      outline: none;
      border-color: var(--accent-color-light);
      box-shadow:
        0 0 0 1px var(--accent-color-light),
        0 0 0 4px rgba(148, 163, 184, 0.4);
    }

    input[type=range] {
      accent-color: var(--accent-color);
    }

    .button-primary {
      background-image: linear-gradient(135deg, var(--accent-color-light), var(--accent-color));
      color: #ffffff;
      font-weight: 600;
      border-radius: 999px;
      padding: 0.6rem 1.6rem;
      border: none;
      box-shadow: 0 10px 20px rgba(15,23,42,0.12);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      font-size: 0.875rem;
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, background-position 0.2s ease-out;
      background-size: 150% 150%;
      background-position: 0% 50%;
      cursor: pointer;
    }
    .button-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(15,23,42,0.18);
      background-position: 100% 50%;
    }
    .button-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
      background-image: none;
      background-color: var(--bg-slider-track);
      color: var(--text-muted);
    }

    html.accent-rainbow .button-primary {
      background-image: linear-gradient(120deg,#fb7185,#f97316,#eab308,#22c55e,#06b6d4,#a855f7);
    }
    html.accent-metallic .button-primary {
      background-image: linear-gradient(135deg,#e5e7eb,#a1a1aa,#d4d4d8);
    }

    .chip {
      border-radius: 999px;
      padding: 0.15rem 0.55rem;
      font-size: 0.68rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .toggle-btn {
      border-radius: 999px;
      padding: 0.3rem 0.9rem;
      font-size: 0.75rem;
      border: 1px solid var(--border-primary);
      background-color: var(--bg-toggle-inactive);
      color: var(--text-secondary);
      cursor: pointer;
      transition: background-color 0.15s ease, color 0.15s ease, border-color 0.15s ease;
    }
    .toggle-btn.active {
      background-color: var(--accent-color-light);
      border-color: var(--accent-color-dark);
      color: #111827;
    }

    .approval-view #inputSection,
    .approval-view #themePanel,
    .approval-view #settingsPanel,
    .approval-view #shareRow {
      display: none;
    }

    .approval-highlight {
      border-radius: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: radial-gradient(circle at top left, rgba(0,192,154,0.08), transparent 60%), var(--bg-card-inner);
      padding: 1rem 1.25rem;
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center bg-white px-4 py-8 text-brand-dark">
  <div class="w-full max-w-xl card-bg px-4 py-5 md:px-6 md:py-6 space-y-5">

    <!-- HEADER -->
    <header class="pb-4 border-b border-primary flex flex-col items-center gap-3">
      <div class="flex flex-col items-center gap-2">
        <div class="h-10 w-10 flex items-center justify-center">
          <!-- Default TrustBureau shield -->
          <svg id="defaultLogoSvg" width="40" height="40" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M25 5L42.5 12.5V27.5C42.5 37.5 25 45 25 45C25 45 7.5 37.5 7.5 27.5V12.5L25 5Z" fill="#00C09A"/>
            <path d="M17.5 25L22.5 30L32.5 20" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <!-- Custom logo (URL) -->
          <img id="customLogoImg" class="hidden h-10 w-10 object-contain rounded-md" alt="Company logo" />
        </div>

        <div class="flex flex-col items-center gap-1">
          <!-- Company name (2x-ish bigger now) -->
          <div id="companyNameDisplay"
               class="font-heading font-semibold text-xl md:text-2xl tracking-tight text-secondary text-center">
            TrustBureau.ai
          </div>
          <div id="poweredByDisplay"
               class="text-[11px] font-semibold text-muted uppercase tracking-[0.18em] text-center">
            APPROVAL CALCULATOR
          </div>
        </div>
      </div>

      <div class="flex flex-wrap items-center justify-center gap-2 pt-1">
        <button id="themeToggle"
                type="button"
                class="toggle-btn flex items-center gap-1">
          <span>Theme</span>
        </button>
        <button id="settingsToggle"
                type="button"
                class="toggle-btn">
          Settings
        </button>
        <button id="resetBtn"
                type="button"
                class="toggle-btn">
          Reset
        </button>
      </div>
    </header>

    <!-- THEME PANEL -->
    <section id="themePanel" class="card-inner-bg p-3 md:p-4 space-y-3 hidden">
      <div class="flex items-center justify-between">
        <span class="text-xs font-semibold text-muted uppercase tracking-[0.16em]">Theme</span>
        <span class="text-[11px] text-muted">Brand, accents &amp; background</span>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted">Base</label>
          <select id="themeSelect" class="input-field text-xs px-2 py-1.5 w-full">
            <option value="trust">TrustBureau.ai</option>
            <option value="light">Light</option>
            <option value="dark">Dark</option>
            <option value="black">AMOLED Black</option>
            <option value="ocean">Ocean</option>
            <option value="neon">Neon</option>
            <option value="unicorn">Unicorn</option>
            <option value="terminal">Terminal</option>
          </select>
        </div>
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted">Accent</label>
          <select id="accentSelect" class="input-field text-xs px-2 py-1.5 w-full">
            <option value="brand">Brand Green</option>
            <option value="gold">Gold</option>
            <option value="blue">Blue</option>
            <option value="emerald">Emerald</option>
            <option value="rainbow">Rainbow</option>
            <option value="metallic">Metallic</option>
          </select>
        </div>
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted">Background</label>
          <select id="backgroundSelect" class="input-field text-xs px-2 py-1.5 w-full">
            <option value="default">Plain</option>
            <option value="soft">Soft Gradient</option>
            <option value="darkmesh">Dark Mesh</option>
            <option value="grid">Grid Overlay</option>
          </select>
        </div>
      </div>

      <div class="pt-3 border-t border-primary grid grid-cols-1 md:grid-cols-2 gap-3">
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted">Logo URL</label>
          <input id="logoUrlInput"
                 type="url"
                 placeholder="https://your-domain.com/logo.png"
                 class="input-field w-full px-3 py-2 text-xs" />
          <p class="text-[11px] text-muted">
            Use a small transparent PNG/SVG/WebP for best results.
          </p>
        </div>
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted">Company Name</label>
          <input id="companyNameInput"
                 type="text"
                 placeholder="Your Company Inc."
                 class="input-field w-full px-3 py-2 text-xs" />
          <p class="text-[11px] text-muted">
            When set, we show your name, and
            <span class="font-semibold">powered by TrustBureau.ai</span> below.
          </p>
        </div>
      </div>
    </section>

    <!-- SETTINGS PANEL (kept simple) -->
    <section id="settingsPanel" class="card-inner-bg p-3 md:p-4 space-y-3 hidden">
      <div class="flex items-center justify-between">
        <span class="text-xs font-semibold text-muted uppercase tracking-[0.16em]">Settings</span>
        <span class="text-[11px] text-muted">Display preferences</span>
      </div>
      <div class="flex flex-wrap gap-2 text-xs">
        <button type="button" class="toggle-btn active" data-mode="monthly">Monthly View</button>
        <button type="button" class="toggle-btn" data-mode="weekly">Weekly View</button>
      </div>
      <p class="text-[11px] text-muted">
        (This is a simple demo toggle – you can wire it into your own logic if you want.)
      </p>
    </section>

    <!-- INPUT SECTION -->
    <section id="inputSection" class="space-y-4">
      <!-- Requested Amount -->
      <div class="space-y-1.5">
        <label class="text-xs font-medium text-muted uppercase tracking-[0.16em]">
          Requested Amount
        </label>
        <div class="relative">
          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-muted text-xs">$</span>
          <input id="requestedAmountInput"
                 type="number"
                 min="0"
                 step="100"
                 class="input-field w-full pl-7 pr-3 py-2 text-sm"
                 value="50000" />
        </div>
        <input id="requestedAmountRange"
               type="range"
               min="5000"
               max="250000"
               step="1000"
               class="w-full mt-1"
               value="50000" />
        <div class="flex justify-between text-[11px] text-muted">
          <span>$5,000</span>
          <span>$250,000</span>
        </div>
      </div>

      <!-- Approval % and Fee % -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted uppercase tracking-[0.16em]">
            Approval %
          </label>
          <div class="flex items-center gap-2">
            <input id="approvalPercentRange"
                   type="range"
                   min="10"
                   max="100"
                   step="5"
                   class="w-full"
                   value="80" />
            <span id="approvalPercentLabel" class="text-xs font-semibold text-secondary w-10 text-right">
              80%
            </span>
          </div>
        </div>
        <div class="space-y-1.5">
          <label class="text-xs font-medium text-muted uppercase tracking-[0.16em]">
            Fee %
          </label>
          <div class="flex items-center gap-2">
            <input id="feePercentRange"
                   type="range"
                   min="5"
                   max="40"
                   step="1"
                   class="w-full"
                   value="22" />
            <span id="feePercentLabel" class="text-xs font-semibold text-secondary w-10 text-right">
              22%
            </span>
          </div>
        </div>
      </div>

      <!-- Term -->
      <div class="space-y-1.5">
        <label class="text-xs font-medium text-muted uppercase tracking-[0.16em]">
          Term (months)
        </label>
        <div class="flex items-center gap-2">
          <input id="termMonthsRange"
                 type="range"
                 min="3"
                 max="36"
                 step="1"
                 class="w-full"
                 value="12" />
          <span id="termMonthsLabel" class="text-xs font-semibold text-secondary w-10 text-right">
            12
          </span>
        </div>
        <div class="flex justify-between text-[11px] text-muted">
          <span>3</span>
          <span>36</span>
        </div>
      </div>
    </section>

    <!-- OUTPUT SECTION -->
    <section id="outputSection" class="space-y-4">
      <div class="approval-highlight flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div>
          <div class="text-[11px] font-semibold text-muted uppercase tracking-[0.16em]">You Get</div>
          <div id="approvedAmountDisplay"
               class="text-2xl md:text-3xl font-heading font-extrabold text-secondary">
            $40,000
          </div>
          <div class="text-[11px] text-muted mt-1">
            Estimated approved amount based on your inputs.
          </div>
        </div>
        <div class="flex flex-col gap-1 text-xs text-muted md:text-right">
          <div>
            <span class="font-medium text-secondary">Total Payback:</span>
            <span id="totalPaybackDisplay" class="ml-1">$48,800</span>
          </div>
          <div>
            <span class="font-medium text-secondary">Estimated Payment:</span>
            <span id="paymentDisplay" class="ml-1">$4,067 / mo</span>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-3 gap-3 text-xs">
        <div class="card-inner-bg flex flex-col px-3 py-2.5">
          <span class="text-[11px] text-muted uppercase tracking-[0.16em]">Approval</span>
          <span id="summaryApproval" class="mt-1 text-sm font-semibold text-secondary">
            80%
          </span>
        </div>
        <div class="card-inner-bg flex flex-col px-3 py-2.5">
          <span class="text-[11px] text-muted uppercase tracking-[0.16em]">Fee %</span>
          <span id="summaryFee" class="mt-1 text-sm font-semibold text-secondary">
            22%
          </span>
        </div>
        <div class="card-inner-bg flex flex-col px-3 py-2.5">
          <span class="text-[11px] text-muted uppercase tracking-[0.16em]">Term</span>
          <span id="summaryTerm" class="mt-1 text-sm font-semibold text-secondary">
            12 mo
          </span>
        </div>
      </div>
    </section>

    <!-- SHARE ROW -->
    <section id="shareRow" class="pt-2 border-t border-primary space-y-2">
      <div class="flex items-center justify-between">
        <span class="text-[11px] font-semibold text-muted uppercase tracking-[0.16em]">
          Share approval
        </span>
        <span class="text-[11px] text-muted">
          Generates a client-friendly link
        </span>
      </div>
      <div class="flex flex-col sm:flex-row gap-2">
        <input id="shareUrlInput"
               type="text"
               readonly
               class="input-field flex-1 px-3 py-2 text-[11px] truncate"
               placeholder="Generate a link to copy" />
        <button id="shareBtn" type="button" class="button-primary text-xs whitespace-nowrap">
          Copy Link
        </button>
      </div>
      <p id="shareStatus" class="text-[11px] text-muted"></p>
    </section>
  </div>

  <!-- Logic -->
  <script>
    (function () {
      const root = document.documentElement;
      const body = document.body;

      /* ---- Elements ---- */
      const themeToggle = document.getElementById('themeToggle');
      const settingsToggle = document.getElementById('settingsToggle');
      const resetBtn = document.getElementById('resetBtn');

      const themePanel = document.getElementById('themePanel');
      const settingsPanel = document.getElementById('settingsPanel');

      const themeSelect = document.getElementById('themeSelect');
      const accentSelect = document.getElementById('accentSelect');
      const backgroundSelect = document.getElementById('backgroundSelect');

      const logoUrlInput = document.getElementById('logoUrlInput');
      const companyNameInput = document.getElementById('companyNameInput');

      const defaultLogoSvg = document.getElementById('defaultLogoSvg');
      const customLogoImg = document.getElementById('customLogoImg');

      const companyNameDisplay = document.getElementById('companyNameDisplay');
      const poweredByDisplay = document.getElementById('poweredByDisplay');

      const requestedAmountInput = document.getElementById('requestedAmountInput');
      const requestedAmountRange = document.getElementById('requestedAmountRange');

      const approvalPercentRange = document.getElementById('approvalPercentRange');
      const approvalPercentLabel = document.getElementById('approvalPercentLabel');

      const feePercentRange = document.getElementById('feePercentRange');
      const feePercentLabel = document.getElementById('feePercentLabel');

      const termMonthsRange = document.getElementById('termMonthsRange');
      const termMonthsLabel = document.getElementById('termMonthsLabel');

      const approvedAmountDisplay = document.getElementById('approvedAmountDisplay');
      const totalPaybackDisplay = document.getElementById('totalPaybackDisplay');
      const paymentDisplay = document.getElementById('paymentDisplay');

      const summaryApproval = document.getElementById('summaryApproval');
      const summaryFee = document.getElementById('summaryFee');
      const summaryTerm = document.getElementById('summaryTerm');

      const shareUrlInput = document.getElementById('shareUrlInput');
      const shareBtn = document.getElementById('shareBtn');
      const shareStatus = document.getElementById('shareStatus');

      const inputSection = document.getElementById('inputSection');
      const shareRow = document.getElementById('shareRow');

      const settingsModeButtons = settingsPanel.querySelectorAll('.toggle-btn[data-mode]');

      const THEME_CLASSES = ['theme-trust', 'theme-light', 'theme-dark', 'theme-black', 'theme-ocean', 'theme-neon', 'theme-unicorn', 'theme-terminal'];
      const ACCENT_CLASSES = ['accent-brand', 'accent-gold', 'accent-blue', 'accent-emerald', 'accent-rainbow', 'accent-metallic'];
      const BG_CLASSES = ['bg-default', 'bg-soft', 'bg-darkmesh', 'bg-grid'];

      const state = {
        requestedAmount: 50000,
        approvalPercent: 80,
        feePercent: 22,
        termMonths: 12,
        theme: 'trust',
        accent: 'brand',
        background: 'default',
        companyName: '',
        logoUrl: '',
        viewMode: 'monthly'  // or weekly (placeholder)
      };

      /* ---- Helpers ---- */
      function clamp(num, min, max) {
        return Math.min(Math.max(num, min), max);
      }

      function formatCurrency(amount) {
        if (!isFinite(amount)) return '$0';
        return new Intl.NumberFormat('en-US', {
          style: 'currency',
          currency: 'USD',
          maximumFractionDigits: 0
        }).format(amount);
      }

      function formatCurrency2(amount) {
        if (!isFinite(amount)) return '$0';
        return new Intl.NumberFormat('en-US', {
          style: 'currency',
          currency: 'USD',
          maximumFractionDigits: 2
        }).format(amount);
      }

      function b64Encode(str) {
        const utf8 = encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (_, p1) =>
          String.fromCharCode('0x' + p1)
        );
        return btoa(utf8);
      }

      function b64Decode(b64) {
        const binary = atob(b64);
        const hex = [];
        for (let i = 0; i < binary.length; i++) {
          const h = binary.charCodeAt(i).toString(16).padStart(2, '0');
          hex.push('%' + h);
        }
        return decodeURIComponent(hex.join(''));
      }

      function applyTheme() {
        THEME_CLASSES.forEach(cls => root.classList.remove(cls));
        ACCENT_CLASSES.forEach(cls => root.classList.remove(cls));
        BG_CLASSES.forEach(cls => root.classList.remove(cls));

        root.classList.add(`theme-${state.theme}`);
        root.classList.add(`accent-${state.accent}`);
        root.classList.add(`bg-${state.background}`);
      }

      function applyBranding() {
        const name = (state.companyName || '').trim();
        const hasCompany = name.length > 0;

        companyNameDisplay.textContent = hasCompany ? name : 'TrustBureau.ai';
        poweredByDisplay.textContent = hasCompany
          ? 'powered by TrustBureau.ai'
          : 'APPROVAL CALCULATOR';

        const url = (state.logoUrl || '').trim();
        if (url) {
          defaultLogoSvg.classList.add('hidden');
          customLogoImg.classList.remove('hidden');
          customLogoImg.src = url;
          customLogoImg.alt = hasCompany ? name + ' logo' : 'Company logo';
        } else {
          customLogoImg.classList.add('hidden');
          customLogoImg.removeAttribute('src');
          defaultLogoSvg.classList.remove('hidden');
        }
      }

      function syncInputsFromState() {
        requestedAmountInput.value = state.requestedAmount;
        requestedAmountRange.value = state.requestedAmount;

        approvalPercentRange.value = state.approvalPercent;
        approvalPercentLabel.textContent = state.approvalPercent + '%';

        feePercentRange.value = state.feePercent;
        feePercentLabel.textContent = state.feePercent + '%';

        termMonthsRange.value = state.termMonths;
        termMonthsLabel.textContent = state.termMonths;

        themeSelect.value = state.theme;
        accentSelect.value = state.accent;
        backgroundSelect.value = state.background;

        logoUrlInput.value = state.logoUrl;
        companyNameInput.value = state.companyName;
      }

      function updateOutputs() {
        const requested = clamp(Number(state.requestedAmount) || 0, 0, 1_000_000);
        const approvalPct = clamp(Number(state.approvalPercent) || 0, 0, 100);
        const feePct = clamp(Number(state.feePercent) || 0, 0, 100);
        const term = clamp(Number(state.termMonths) || 1, 1, 120);

        const approved = requested * (approvalPct / 100);
        const totalPayback = approved * (1 + feePct / 100);
        let payment = totalPayback / term;

        if (state.viewMode === 'weekly') {
          // ↳ crude conversion: 1 month ≈ 4.33 weeks
          const totalWeeks = term * 4.33;
          payment = totalPayback / totalWeeks;
        }

        approvedAmountDisplay.textContent = formatCurrency(approved);
        totalPaybackDisplay.textContent = formatCurrency( totalPayback );
        paymentDisplay.textContent = formatCurrency2(payment) + (state.viewMode === 'weekly' ? ' / wk' : ' / mo');

        summaryApproval.textContent = approvalPct + '%';
        summaryFee.textContent = feePct + '%';
        summaryTerm.textContent = term + (state.viewMode === 'weekly' ? ' mo (weekly)' : ' mo');
      }

      function updateViewFromURL() {
        const params = new URLSearchParams(window.location.search);
        const isApprovalView = params.get('view') === 'approval';
        body.classList.toggle('approval-view', isApprovalView);
      }

      function loadConfigFromURL() {
        let encoded = null;

        if (window.location.hash && window.location.hash.includes('c=')) {
          const hash = window.location.hash.substring(1); // remove '#'
          const hashParams = new URLSearchParams(hash);
          encoded = hashParams.get('c');
        } else {
          const params = new URLSearchParams(window.location.search);
          encoded = params.get('c');
        }

        if (!encoded) return;

        try {
          const json = b64Decode(encoded);
          const cfg = JSON.parse(json);

          if (typeof cfg.requestedAmount === 'number') state.requestedAmount = cfg.requestedAmount;
          if (typeof cfg.approvalPercent === 'number') state.approvalPercent = cfg.approvalPercent;
          if (typeof cfg.feePercent === 'number') state.feePercent = cfg.feePercent;
          if (typeof cfg.termMonths === 'number') state.termMonths = cfg.termMonths;

          if (typeof cfg.theme === 'string') state.theme = cfg.theme;
          if (typeof cfg.accent === 'string') state.accent = cfg.accent;
          if (typeof cfg.background === 'string') state.background = cfg.background;

          if (typeof cfg.companyName === 'string') state.companyName = cfg.companyName;
          if (typeof cfg.logoUrl === 'string') state.logoUrl = cfg.logoUrl;

          if (cfg.viewMode === 'weekly' || cfg.viewMode === 'monthly') {
            state.viewMode = cfg.viewMode;
          }
        } catch (e) {
          console.warn('Failed to parse config from URL', e);
        }
      }

      function buildShareUrl() {
        const base = `${window.location.origin}${window.location.pathname}`;
        const params = new URLSearchParams({ view: 'approval' });

        const payload = {
          requestedAmount: state.requestedAmount,
          approvalPercent: state.approvalPercent,
          feePercent: state.feePercent,
          termMonths: state.termMonths,
          theme: state.theme,
          accent: state.accent,
          background: state.background,
          companyName: state.companyName,
          logoUrl: state.logoUrl,
          viewMode: state.viewMode
        };

        let encoded = '';
        try {
          encoded = b64Encode(JSON.stringify(payload));
        } catch {
          encoded = '';
        }

        if (!encoded) {
          return `${base}?${params.toString()}`;
        }

        const hashParams = new URLSearchParams({ c: encoded });
        return `${base}?${params.toString()}#${hashParams.toString()}`;
      }

      function togglePanel(panel) {
        if (!panel) return;
        const isHidden = panel.classList.contains('hidden');
        themePanel.classList.add('hidden');
        settingsPanel.classList.add('hidden');
        if (isHidden) panel.classList.remove('hidden');
      }

      function resetState() {
        state.requestedAmount = 50000;
        state.approvalPercent = 80;
        state.feePercent = 22;
        state.termMonths = 12;
        state.theme = 'trust';
        state.accent = 'brand';
        state.background = 'default';
        state.companyName = '';
        state.logoUrl = '';
        state.viewMode = 'monthly';
      }

      /* ---- Wire events ---- */

      themeToggle.addEventListener('click', () => {
        togglePanel(themePanel);
      });

      settingsToggle.addEventListener('click', () => {
        togglePanel(settingsPanel);
      });

      resetBtn.addEventListener('click', () => {
        resetState();
        applyTheme();
        applyBranding();
        syncInputsFromState();
        updateOutputs();
        shareStatus.textContent = '';
        shareUrlInput.value = '';
        themePanel.classList.add('hidden');
        settingsPanel.classList.add('hidden');
      });

      requestedAmountInput.addEventListener('input', () => {
        const val = Number(requestedAmountInput.value) || 0;
        state.requestedAmount = clamp(val, 0, 1_000_000);
        requestedAmountRange.value = state.requestedAmount;
        updateOutputs();
      });

      requestedAmountRange.addEventListener('input', () => {
        state.requestedAmount = Number(requestedAmountRange.value) || 0;
        requestedAmountInput.value = state.requestedAmount;
        updateOutputs();
      });

      approvalPercentRange.addEventListener('input', () => {
        state.approvalPercent = Number(approvalPercentRange.value) || 0;
        approvalPercentLabel.textContent = state.approvalPercent + '%';
        updateOutputs();
      });

      feePercentRange.addEventListener('input', () => {
        state.feePercent = Number(feePercentRange.value) || 0;
        feePercentLabel.textContent = state.feePercent + '%';
        updateOutputs();
      });

      termMonthsRange.addEventListener('input', () => {
        state.termMonths = Number(termMonthsRange.value) || 0;
        termMonthsLabel.textContent = state.termMonths;
        updateOutputs();
      });

      themeSelect.addEventListener('change', () => {
        state.theme = themeSelect.value || 'trust';
        applyTheme();
      });

      accentSelect.addEventListener('change', () => {
        state.accent = accentSelect.value || 'brand';
        applyTheme();
      });

      backgroundSelect.addEventListener('change', () => {
        state.background = backgroundSelect.value || 'default';
        applyTheme();
      });

      logoUrlInput.addEventListener('change', () => {
        state.logoUrl = logoUrlInput.value || '';
        applyBranding();
      });

      companyNameInput.addEventListener('input', () => {
        state.companyName = companyNameInput.value || '';
        applyBranding();
      });

      settingsModeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const mode = btn.getAttribute('data-mode');
          if (!mode) return;
          state.viewMode = mode;
          settingsModeButtons.forEach(b => b.classList.toggle('active', b === btn));
          updateOutputs();
        });
      });

      shareBtn.addEventListener('click', async () => {
        const url = buildShareUrl();
        shareUrlInput.value = url;
        shareStatus.textContent = '';

        try {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(url);
            shareStatus.textContent = 'Link copied to clipboard.';
          } else {
            shareStatus.textContent = 'Link generated. Copy it manually.';
          }
        } catch {
          shareStatus.textContent = 'Link generated. Copy it manually.';
        }
      });

      /* ---- Init ---- */
      loadConfigFromURL();
      applyTheme();
      applyBranding();
      syncInputsFromState();
      updateOutputs();
      updateViewFromURL();
    })();
  </script>
</body>
</html>
